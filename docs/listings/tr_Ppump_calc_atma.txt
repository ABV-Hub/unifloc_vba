' функция расчета  давления давления на приеме по дин уровню
' входные параметры адаптированы для данных тех режима скважин
' возвращает абсолютное значение давления!
Public Function tr_Ppump_calc_atma(Ksep_fr As Double, _
        Hvd_m As Double, Udl_Hvd_m As Double, _
        Hpump_m As Double, Dcas_mm As Double, _
        Hdyn_m As Double, Pcas_atmg As Double, _
        Pb_atma As Double, rs_m3t As Double, _
        Qliq_sm3day As Double, _
        Optional bo_m3m3 As Double = 1.2, _
        Optional gamma_oil As Double = 860, _
        Optional wc_perc As Double = 0, _
        Optional gamma_wat As Double = 1000, _
        Optional Qg_mes_sm3day As Double = -1, _
        Optional tr_HydCor As Integer = 2, _
        Optional dtub_mm As Double = 60, _
        Optional Bw_m3m3 As Double = 1, _
        Optional Tres_C As Double = 60, _
        Optional Zav As Double = 0.9, _
        Optional gamma_gas As Double = 0.8, _
        Optional Udl_Hpump_m As Double = -1, _
        Optional Udl_Hdyn_m As Double = -1)
' Ksep_fr       - коэффициент сепарации насоса, доли
' Hvd_m         - глубина верхних дыр перфорации, измеренная, м
' Udl_Hvd_m     - удлинение на глубину верхних дыр перфорации, м
' Hpump_m       - глубина спуска насоса, измеренная, м
' Dcas_mm       - внутренний диаметр эксплуатационной коллоны, мм
' Hdyn_m        - динамический уровень измеренный, м
' Pcas_atmg     - затрубное давление, атм избыточное
' Pb_atma       - давление насыщения, атм абсолютное
' rp_m3t        - газовый фактор, м3/т
' Qliq_sm3day   - дебит жидкости в стандартных условиях, м3/сут
'                   опциональные параметры
' bo_m3m3       - объемный коэффициент нефти, м3/м3
' gamma_oil     - плотность нефти в стандартных условиях, г/см3
' wc_perc       - обводненность в стандартных условиях, %
' gamma_wat     - плотность воды, кг/м3
' Qg_mes_sm3day - замер расхода газа в затрубе,
'                например по отжиму. если < 0 игнорируется
' tr_HydCor   -  корреляция для расчета градиента давления
' Dtub_mm = 60  - внешний диаметр НКТ, мм
' Bw_m3m3 = 1   - объемный коэффициент для воды
' Tres_C = 60   - температура пластовая, C
' Zav = 0.9     - сверхсжимаемость газа в затрубе
' GammaGas=0.8  - плотность газа
' Udl_Hpump_m   - удлинение на глубину спуска насоса
' Udl_Hdyn_m    - удлинение на глубину динамического уровня