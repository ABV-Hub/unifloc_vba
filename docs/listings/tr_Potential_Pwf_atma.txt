' функция расчета целевого забойного давления по доле газа
Public Function tr_Potential_Pwf_atma(ByVal P_cur_atma As Double, _
            Plin_atmg As Double, ByVal FreeGas As Double, _
            ByVal wc_perc As Double, _
            ByVal rp_m3t As Double, ByVal Tres_C As Double, _
            ByVal Ksep_fr As Double, _
            ByVal gamma_oil As Double, _
            Optional pvt_cor As Integer = 0, _
            Optional Hpump_m As Double = 0, _
            Optional Hvd_m As Double = 0, _
            Optional Udl_Hvd_m As Double = 0, _
            Optional Pb_atma As Double = 150, _
            Optional Qliq_sm3day As Double = 100, _
            Optional Dcas_mm As Double = 132, _
            Optional bo_m3m3 As Double = 1.2, _
            Optional gamma_wat As Double = 1, _
            Optional Udl_Hpump_m_max As Double = -1, _
            Optional Layer = "", _
            Optional comp = "", _
            Optional gamma_gas = 0.8) As Double
' P_cur_atma    - текущее забойное давление. Целевое не больше
' Plin_atmg     - линейное давление, измеренное, атм
' FreeGas       - допустимая предельная доля газа в потоке
' wc_perc       - обводненность в стандартных условиях, %
' rp_m3t        - газовый фактор, м3/т
' Tres_C = 60   - температура пластовая, C
' Ksep_fr       - коэффициент сепарации насоса, доли
' gamma_oil     - плотность нефти в стандартных условиях, г/см3
' pvt_cor       - корреляция для PVT, номер набора
' Hpump_m       - глубина спуска насоса, измеренная, м
' Hvd_m         - глубина верхних дыр перфорации, измеренная, м
' Udl_Hvd_m     - удлинение на глубину верхних дыр перфорации, м
' Pb_atma       - давление насыщения, атм абсолютное
' Qliq_sm3day   - дебит жидкости в стандартных условиях, м3/сут
' Dcas_mm       - внутренний диаметр эксплуатационной коллоны, мм
' bo_m3m3       - объемный коэффициент нефти, м3/м3
' gamma_oil     - плотность воды в стандартных условиях, г/см3
' Dtub_mm = 72  - внешний диаметр НКТ, мм
' Udl_Hpump_m   - удлинение на глубину спуска насоса
' gamma_gas =0.8  - плотность газа
' Layer         - название пласта   не используется
' comp          - тип скважины (ГОР или ВЕРТ) не используется