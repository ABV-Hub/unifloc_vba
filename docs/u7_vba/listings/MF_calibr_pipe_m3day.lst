'  подбор параметров потока через трубу при известном
'  перепаде давления с использованием многофазных корреляций
Public Function MF_calibr_pipe_m3day( _
        ByVal qliq_sm3day As Double, _
        ByVal fw_perc As Double, _
        ByVal length_m As Double, _
        ByVal pin_atma As Double, _
        ByVal pout_atma As Double, _
        Optional ByVal str_PVT As String = PVT_DEFAULT, _
        Optional ByVal theta_deg As Double = 90, _
        Optional ByVal d_mm As Double = 60, _
        Optional ByVal hydr_corr As H_CORRELATION = 0, _
        Optional ByVal tcalc_C As Double = 50, _
        Optional ByVal tother_C As Double = -1, _
        Optional ByVal c_calibr_grav = 1, _
        Optional ByVal c_calibr_fric = 1, _
        Optional ByVal roughness_m As Double = 0.0001, _
        Optional ByVal calibr_type As Integer = 0)
' Обязательные параметры
' qliq_sm3day - дебит жидкости в поверхностных условиях
' fw_perc     - обводненность
' Length_m    - Длина трубы, измеренная, м
' pin_atma    - давление на входе потока в трубу, атм
'               граничное значение для проведения расчета
' pout_atma   - давление на выходе потока из трубы, атм
'               граничное значение для проведения расчета
' Необязательные параметры
' стандартные набор PVT параметров
' str_PVT      - закодированная строка с параметрами PVT.
'               если задана - перекрывает другие значения
' theta_deg   - угол направления потока к горизонтали
'               (90 - вертикальная труба поток вверх
'                -90 - вертикальная труба поток вниз)
'               может принимать отрицательные значения
' d_mm        - внутрнний диаметр трубы
' hydr_corr    - гидравлическая корреляция, H_CORRELATION
'                  BeggsBrill = 0
'                  Ansari = 1
'                  Unified = 2
'                  Gray = 3
'                  HagedornBrown = 4
'                  SakharovMokhov = 5
' Tcalc_C     - температура в точке где задано давление, С
' Tother_C    - температура на другом конце трубы
'               по умолчанию температура вдоль трубы постоянна
'               если задано то меняется линейно по трубе
' c_calibr_grav  - поправка на гравитационную составляющую
'               перепада давления
' c_calibr_fric  - поправка на трение в перепаде давления
' roughness_m - шероховатость трубы
' calibr_type - тип калибровки
'             0 - подбор подстроечных коэффициентов корреляции
'             1 - подбор дебита
'             2 - подбор обводненности
'             3 - подбор газового фактор
'             4 - минимизация нескольких параметров
' результат   - число - давление на другом конце трубы atma.
