' функция адаптации модели скважины по данным эксплуатации
' подбирает коэффициента деградации УЭЦН и штуцера
' по замера на поверхности и на забое/приеме насоса
Public Function Well_calcKdegr_fr( _
                     ByVal Q_m3Day As Double, _
                     ByVal fw_perc As Double, _
                     ByVal Pdown_atma As Double, _
                     ByVal Pbuf_atma As Double, _
            Optional Pdown_at_intake As Boolean = False, _
            Optional ByVal Plin_atma As Double = -1, _
            Optional ByVal Pcas_atma As Double = -1, _
            Optional ByVal wellStr As String = WELL_DEFAULT, _
            Optional ByVal PVTstr As String = PVT_DEFAULT, _
            Optional ByVal ESPStr As String = ESP_DEFAULT, _
            Optional ByVal HydrCorr As H_CORRELATION = 0, _
            Optional ByVal Ksep_fr As Double = -1, _
            Optional ByVal Kdegr_d As Double = 0, _
            Optional ByVal param_num As Integer = 0)
' исходные параметры
' Q_m3Day    - дебит жидкости, на поверхности
' fw_perc    - обводненность (объемная на поверхности)
' Pdown_atma - давление ниже насоса (внизу) для расчета
'     либо забойное давление (по умолчанию)
'     либо давление на приеме
'     определяется опциональным параметром Pdown_at_intake
' Pbuf_atma  - буферное давление
' ----------- опциональные параметры
' Pdown_at_intake - флаг определяет точку расчета давления
'                   ниже насоса. По умолчанию забойное
' Plin_atma - линейное давление
'             если не задано штуцер не учитывается
' Pcas_atma - затрубное давление
'     если не задано динамический уровень не рассчитывается
' wellStr  - закодированные параметры конструкции скважины
' PVTstr - закодированные параметры флюидов
' ESPStr - закодированные параметры УЭЦН
' HydrCorr      - гидравлическая корреляция, H_CORRELATION
'                   BeggsBriilCor = 0
'                   AnsariCor = 1
'                   UnifiedCor = 2
'                   Gray = 3
'                   HagedornBrown = 4
'                   SakharovMokhov = 5
' Ksep_fr - коэффициент сепарации.
'           если задан - то используется вместо расчетного
'           явное задание коэффициента серации ускоряет расчет
' Kdegr_d - коэффициент деградации УЭЦН
' param_num - параметры для вывода в качестве результата
'             если не задан выводятся все в виде массива
' ----------- результаты расчета
' массив параметры работы системы "пласт - скважина - УЭЦН"
