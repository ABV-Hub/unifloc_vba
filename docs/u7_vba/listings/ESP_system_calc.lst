' расчет производительности системы УЭЦН
' считает перепад давления, электрические параметры и деградацию КПД
Public Function ESP_system_calc( _
                 ByVal Qliq_sm3day As Double, _
                 ByVal fw_perc As Double, _
                 ByVal P_atma As Double, _
        Optional ByVal NumStages As Integer = 1, _
        Optional ByVal freq_Hz As Double = 50, _
        Optional ByVal PumpID = 674, _
        Optional ByVal PVTstr As String, _
        Optional ByVal Tin_C As Double = 50, _
        Optional ByVal Tdis_C As Double = 50, _
        Optional ByVal CalcFromIntake As Boolean = 1, _
        Optional ByVal GasDegtType As Integer = 0, _
        Optional ByVal Kdegr As Double = 0, _
        Optional ByVal ESP_Power_fact_W As Double = 20, _
        Optional ByVal ESP_U_V As Double = 1000, _
        Optional ByVal ESP_Motor_power_nom_kW = 20, _
        Optional ByVal ESP_cable_type As Integer = 1, _
        Optional ByVal ESP_Hmes_m As Double = 1000)
' Qliq_sm3day       - дебит жидкости на поверхности
' fw_perc           - обводненность
' P_atma            - давление для которого делается расчет
'                     либо давление на приеме насоса
'                     либо давление на выкиде насоса
'                     определяется параметром CalcFromIntake
' NumStages         - количество ступеней
' freq_Hz           - частота, Гц
' PumpID            - идентификатор насоса
' PVTstr            - набор данных PVT
' Tin_C             - температура на приеме насоа
' Tdis_C            - температура на выкиде насоса.
'                     если = 0 и CalcFromIntake = 1 то рассчитывается
' CalcFromIntake    - режим расчета снизу вверх или сверху вниз
'                 CalcFromIntake = True => P_atma давление на приеме
'                 CalcFromIntake = False => P_atma давление на выкиде
' GasDegtType       - тип насоса по работе с газом
'      GasDegtType = 0 нет коррекции
'      GasDegtType = 1 стандартный ЭЦН (предел 25%)
'      GasDegtType = 2 ЭЦН с газостабилизирующим модулем (предел 50%)
'      GasDegtType = 3 ЭЦН с осевым модулем (предел 75%)
'      GasDegtType = 4 ЭЦН с модифицированным ступенями (предел 40%)
'                 предел по доле газа на входе в насос после сепарации
'                 на основе статьи SPE 117414 (с корректировкой)
'                 поправка дополнительная к деградации (суммируется)
' Kdegr             - коэффициент деградации напора
' ESP_Power_fact_W  - фактическое потребление мощности ЭЦН
' ESP_U_V           - напряжение на высокой стороне на трансформаторе
' ESP_Motor_power_nom_kW - номинальная мощность двигателя
' ESP_cable_type    - тип кабельной линии
'                   тип 1: cable_R_Omkm = 1.18
'                          cable_name = "КПпАпБП-120 3x16"
'                          cable_Tmax_C = 120
' ESP_Hmes_m        - длина кабельной линии
' результат   - массив значений включающий
'                   перепад давления
'                   перепад температур
'                   мощность потребляемая с вала, Вт
'                   мощность гидравлическая по перекачке жидкости, Вт
'                   КПД ЭЦН
'                   список неполон
