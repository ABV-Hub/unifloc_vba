' расчет производительности системы УЭЦН
' считает перепад давления, электрические параметры и деградацию КПД
Public Function ESP_system_calc( _
                 ByVal Qliq_sm3day As Double, _
                 ByVal fw_perc As Double, _
                 ByVal P_atma As Double, _
        Optional ByVal PVTstr As String, _
        Optional ByVal ESPstr As String, _
        Optional ByVal CalcFromIntake As Boolean = 1 _
        )
' Qliq_sm3day       - дебит жидкости на поверхности
' fw_perc           - обводненность
' P_atma            - давление для которого делается расчет
'                     либо давление на приеме насоса
'                     либо давление на выкиде насоса
'                     определяется параметром CalcFromIntake
' PVTstr            - набор данных PVT
' ESPstr            - набор данных ЭЦН
' CalcFromIntake    - режим расчета снизу вверх или сверху вниз
'                 CalcFromIntake = True => P_atma давление на приеме
'                 CalcFromIntake = False => P_atma давление на выкиде
' результат   - массив значений включающий
'                   перепад давления
'                   перепад температур
'                   мощность потребляемая с вала, Вт
'                   мощность гидравлическая по перекачке жидкости, Вт
'                   КПД ЭЦН
'                   список неполон
