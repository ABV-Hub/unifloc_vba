' функция расчета забойного давления по устьевому для скважины
' расчет сверху-вниз, считает быстро за счет угадывания сепарации
'                     температура только линейная или по градиенту
Public Function well_pwf_plin_atma( _
                 ByVal q_m3day As Double, _
                 ByVal fw_perc As Double, _
                 ByVal plin_atma As Double, _
        Optional ByVal Pcas_atma As Double = -1, _
        Optional ByVal str_well As String = WELL_DEFAULT, _
        Optional ByVal str_PVT As String = PVT_DEFAULT, _
        Optional ByVal str_ESP As String = 0, _
        Optional ByVal hydr_corr As H_CORRELATION = 0, _
        Optional ByVal ksep_fr As Double = -1, _
        Optional ByVal Psep_atma As Double = 40, _
        Optional ByVal Tsep_C As Double = 40, _
        Optional ByVal c_calibr_head_d As Double = 0, _
        Optional ByVal param_num As Integer = 5)
' q_m3day    - дебит жидкости, на поверхности
' fw_perc    - обводненность (объемная на поверхности)
' plin_atma - линейное (устьевое) давление
'
' Pcas_atma - затрубное давление
'     если не задано динамический уровень не рассчитывается
' str_well  - закодированные параметры конструкции скважины.
'           Если не указано,
'           используются свойства скважины по умолчанию.
' str_PVT - закодированные параметры флюидов. Если не указано,
'          используются свойства флюида по умолчанию.
' str_ESP - закодированные параметры УЭЦН. Если
'          не задано или задано значение 0
'          то УЭЦН не учитывается, проводится расчет для
'          фонтанирующей скважины.
' hydr_corr      - гидравлическая корреляция:
'                   BeggsBrill = 0;
'                   Ansari = 1;
'                   Unified = 2;
'                   Gray = 3;
'                   HagedornBrown = 4;
'                   SakharovMokhov = 5.
' ksep_fr - коэффициент сепарации.
'           если задан - то используется вместо расчетного
'           явное задание коэффициента серации ускоряет расчет
' Psep_atma - давление сепарации
' Tsep_C - температура сепарации
'           при расчете сверху вниз неизвестны параметры сепарации
'           если задать их явно (угадать)
'           тогда расчет упрощается и ускоряется
' c_calibr_head_d - коэффициент деградации УЭЦН
' param_num - параметры для вывода в качестве результата
'             если не задан выводятся все в виде массива
' ----------- результаты расчета
' массив параметры работы системы пласт - скважина - УЭЦН
