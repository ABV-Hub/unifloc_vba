' функция расчета узлового анализа системы "пласт - скважина - УЭЦН"
' по заданным параетрам пласта, скважины и УЭЦН
' определяется рабочий дебит и забойное давление
Public Function nodal_Qliq_scm3day( _
             ByVal PI_sm3dayatm As Double, _
             ByVal Plin_atma As Double, _
             ByVal fw_perc As Double, _
    Optional ByVal Pres_atma = 250, _
    Optional ByVal Pcas_atma As Double = 10, _
    Optional ByVal wellStr As String = WELL_DEFAULT, _
    Optional ByVal PVTstr As String = PVT_DEFAULT, _
    Optional ByVal ESPStr As String = ESP_DEFAULT, _
    Optional ByVal HydrCorr As H_CORRELATION = 0, _
    Optional ByVal Ksep_fr As Double = 0, _
    Optional ByVal Kdegr_d As Double = 0, _
    Optional ByVal param_num As Integer = 0)
' исходные параметры
' PI_sm3dayatm - коэффициент продуктивности пласта
' Plin_atma - линейное давление
' fw_perc   - обводненность (объемная на поверхности)
' ----------- опциональные параметры
' Pres_atma - пластовое давление
' Pcas_atma - затрубное давление (для определения Ндин)
' wellStr   - закодированные параметры конструкции скважины
' PVTstr    - закодированные параметры флюидов
' ESPStr    - закодированные параметры УЭЦН
' HydrCorr  - гидравлическая корреляция, H_CORRELATION
'                   BeggsBriilCor = 0
'                   AnsariCor = 1
'                   UnifiedCor = 2
'                   Gray = 3
'                   HagedornBrown = 4
'                   SakharovMokhov = 5
' Ksep_fr   - коэффициент сепарации.
'           если задан - то используется вместо расчетного
'           явное задание коэффициента серации ускоряет расчет
' Kdegr_d   - коэффициент деградации УЭЦН
' param_num - параметры для вывода в качестве результата
'             если не задан выводятся все в виде массива
' ----------- результаты расчета
' массив параметры работы системы "пласт - скважина - УЭЦН"
