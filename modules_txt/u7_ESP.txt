'=======================================================================================
'Unifloc7.2  Canis Lupus                                          khabibullinra@gmail.com
'Библиотека расчетных модулей по нефтяному инжинирингу
'2000 - 2018 г
'
'=======================================================================================
' Работа с базой насосов
'
'
'
'
Public ESPbase As CESPBase
Public ESP As CESPpump
Public Motor As New CESPMotor
Public MotorBase As New CESPMotorBase
Public Function LoadESPbase() As Boolean
' загрузка насоса с нужным ID из базы насосов
    Dim numESP As Integer
On Error GoTo err1:
    addLogMsg "Загружаем базу насосов"
    Set ESPbase = New CESPBase
    Call ESPbase.LoadDB
    numESP = ESPbase.NumPumps
    addLogMsg "Базу насосов загрузили, всего найдено " & numESP & " насосов"
    
'    Set ESP = ESPbase.GetPump(ID) ' ESPcollection.Item(CStr(ID))
    LoadESPbase = True
Exit Function
err1:
    addLogMsg "Не удалось загрузить базу насосов."
    LoadESPbase = False
End Function
Public Function checkID(ID) As Boolean
' проверка соотвествует ли переданный ID тому который загружен во временную переменную
On Error GoTo err1:
    If ESP Is Nothing Then
        If Not LoadESPbase Then checkID = False
        Set ESP = ESPbase.GetPump(ID) ' ESPcollection.Item(CStr(ID))
        checkID = True
    End If
    If ESP.ID = ID Then
        checkID = True
    Else
        Set ESP = ESPbase.GetPump(ID) ' ESPcollection.Item(CStr(ID))
        checkID = True
    End If
Exit Function
err1:
    addLogMsg "Ошибка при проверке насоса ID " & ID & " ."
    checkID = False
End Function
Public Function getESP(ID) As CESPpump
    Dim newESP As New CESPpump
    If checkID(ID) Then
        Call newESP.Copy(ESP)
        Set getESP = newESP
    End If
End Function
