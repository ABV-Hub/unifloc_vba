            '=======================================================================================
'Unifloc 7.7  Vulpes zerda                                           khabibullin.ra@gubkin.ru
'Petroleum engineering calculations modules (macroses)
'2000 - 2019
'
'=======================================================================================
'
Option Explicit
' класс для обеспечения работы с технологическим режимом скважин (любой двухмерной таблицей с данными)
' нужен для упрощения работы с массовыми расчетами по тех режиму
'
'
 Public WS As Worksheet   ' лист в котором находится таблица
 Public firstRow As Integer ' номер строки с которой начинается таблица
 Public wellCol As Integer
 Public outFirstCol As Integer
 Private rng_wellName As Range
 
' параметры конструкции скважины
 Private rng_Hvd_m As Range
 Private rng_UdlHvd_m As Range
 Private rng_hpump_m As Range
 Private rng_UdlHpump_m As Range
 Private rng_d_cas_mm As Range
 Private rng_dtub_mm As Range
 Private rng_dchoke_mm As Range
 
' параметры с которыми можно работать
 Private rng_pwf_atma As Range
 Private rng_Pint_atma As Range
 Private rng_pbuf_atma As Range
 Private rng_Pann_atma As Range
 Private rng_Pline_atma As Range
 Private rng_Pdis_atma As Range
 Private rng_Hdyn_m As Range
 Private rng_UdlHdyn_m As Range
 
 ' замеры по работе скважины
 Private rng_qliq_m3day As Range
 Private rng_Qoil_tday As Range
 Private rng_fw_perc As Range
 Private rng_PKV_twork_min As Range
 Private rng_PKV_tstop_min As Range
 Private rng_PKV_work_hrday As Range  ' доля работы скважин на ПКВ режиме по тех режиму часы в день
 
 ' PVT
 Private rng_GOR_m3m3 As Range
 Private rng_Rs_m3m3 As Range
 Private rng_pb_atma As Range
 Private rng_bob_m3m3 As Range
 Private rng_tres_C As Range
 Private rng_MubOil_cP As Range
 Private rng_rho_oil_sckgm3 As Range
 Private rng_rho_gas_sckgm3 As Range
 Private rng_gammaGas As Range
 Private rng_gammaOil As Range
 Private rng_gammaWater As Range
 
 Private rng_Nelectric_kwhrday As Range
 
 
 ' параметры для выводв для анализа КПД ДВА
 Private outRng_PKV_time_frac As Range
 Private outRng_QliqInst_m3day As Range   ' мгновенный дебит скважины
 Private outRng_fw_frac As Range
 Private outRng_pbuf_atma As Range
 Private outRng_pwf_atma As Range
 Private outRng_Pint_atma As Range
 Private outRng_Tintake_C As Range
 Private outRng_Ksepnat_frac As Range
 Private outRng_KsepGS_frac As Range
 Private outRng_GasFrac_frac As Range
 Private outRng_Pdis_atma As Range
 Private outRng_Tdis_C As Range
 Private outRng_QmixIntake_m3day As Range
 Private outRng_QmixDis_m3day As Range
 Private outRng_QmixAv_m3day As Range
 Private outRng_Ngidr_kW As Range
 Private outRng_Nelctric_kW As Range
 Private outRng_KPD_frac As Range
 Private outRng_msg As Range
 
 Private Function writeByName(rng_name As Range, I, Val)
    rng_name.Cells(firstRow + I, 1) = Val
    writeByName = True
 End Function
 Private Function readByName(rng_name As Range, I)
    readByName = rng_name.Cells(firstRow + I, 1)
 End Function
 
Public Sub SetStandardTRlayout(sheet As Worksheet)
    firstRow = 10
    wellCol = 5
    outFirstCol = 225
    Set WS = sheet
    
    Set rng_wellName = WS.Columns(wellCol) '
    Set rng_Hvd_m = WS.Columns(wellCol + 8)
    Set rng_UdlHvd_m = WS.Columns(wellCol + 9)
    Set rng_hpump_m = WS.Columns(wellCol + 16)
    Set rng_UdlHpump_m = WS.Columns(wellCol + 155)
    Set rng_d_cas_mm = WS.Columns(wellCol + 5)
    Set rng_dtub_mm = WS.Columns(wellCol + 6)
    Set rng_dchoke_mm = WS.Columns(wellCol + 7)
    ' параметры с которыми можно работать
     Set rng_pwf_atma = WS.Columns(wellCol + 23)
     Set rng_Pint_atma = WS.Columns(wellCol + 22)
     Set rng_pbuf_atma = WS.Columns(wellCol + 17)
     Set rng_Pann_atma = WS.Columns(wellCol + 21)
     Set rng_Pline_atma = WS.Columns(wellCol + 18)
     Set rng_Pdis_atma = WS.Columns(outFirstCol + 1)
     Set rng_Hdyn_m = WS.Columns(wellCol + 20)
     Set rng_UdlHdyn_m = WS.Columns(wellCol + 156)
     ' замеры по работе скважины
     Set rng_qliq_m3day = WS.Columns(wellCol + 25)
     Set rng_Qoil_tday = WS.Columns(wellCol + 24)
     Set rng_fw_perc = WS.Columns(wellCol + 26)
     ' PVT
     Set rng_GOR_m3m3 = WS.Columns(wellCol + 31)
     Set rng_Rs_m3m3 = WS.Columns(wellCol + 31)
     Set rng_pb_atma = WS.Columns(wellCol + 30)
     Set rng_bob_m3m3 = WS.Columns(wellCol + 40)
     Set rng_tres_C = WS.Columns(wellCol + 32)
     Set rng_MubOil_cP = WS.Columns(wellCol + 37)
     Set rng_rho_oil_sckgm3 = WS.Columns(wellCol + 41)
'     Set rng_rho_gas_sckgm3 = WS.Columns(wellCol)
'     Set rng_gammaGas = WS.Columns(wellCol)
     Set rng_gammaOil = WS.Columns(wellCol + 41)
     Set rng_gammaWater = WS.Columns(wellCol + 42)
     
     Set rng_PKV_work_hrday = WS.Columns(wellCol + 169)
     
     Set rng_Nelectric_kwhrday = WS.Columns(wellCol + 210)
        
    ' параметры для выводв для анализа КПД ДВА
    Set outRng_PKV_time_frac = WS.Columns(outFirstCol + 1)
    Set outRng_QliqInst_m3day = WS.Columns(outFirstCol + 2)    ' мгновенный дебит скважины
    Set outRng_fw_frac = WS.Columns(outFirstCol + 3)
    Set outRng_pbuf_atma = WS.Columns(outFirstCol + 4)
    Set outRng_pwf_atma = WS.Columns(outFirstCol + 5)
    Set outRng_Pint_atma = WS.Columns(outFirstCol + 6)
    Set outRng_Tintake_C = WS.Columns(outFirstCol + 7)
    Set outRng_Ksepnat_frac = WS.Columns(outFirstCol + 8)
    Set outRng_KsepGS_frac = WS.Columns(outFirstCol + 9)
    Set outRng_GasFrac_frac = WS.Columns(outFirstCol + 10)
    Set outRng_Pdis_atma = WS.Columns(outFirstCol + 11)
    Set outRng_Tdis_C = WS.Columns(outFirstCol + 12)
    Set outRng_QmixIntake_m3day = WS.Columns(outFirstCol + 13)
    Set outRng_QmixDis_m3day = WS.Columns(outFirstCol + 14)
    Set outRng_QmixAv_m3day = WS.Columns(outFirstCol + 15)
    Set outRng_Ngidr_kW = WS.Columns(outFirstCol + 16)
    Set outRng_Nelctric_kW = WS.Columns(outFirstCol + 17)
    Set outRng_KPD_frac = WS.Columns(outFirstCol + 18)
    Set outRng_msg = WS.Columns(outFirstCol + 19)
End Sub
 
Private Sub Class_Initialize()
  firstRow = 1
  'col_pwf_atma = "столбец_первый"
End Sub
' свойсва для чтения отдельных параметров
 Public Property Let pwf_atma(I, Val)
    Call writeByName(rng_pwf_atma, I, Val)
 End Property
 Public Property Get pwf_atma(I)
   pwf_atma = readByName(rng_pwf_atma, I)
 End Property
'============================================
 Public Property Let wellName(I, Val)
    Call writeByName(rng_wellName, I, Val)
 End Property
 
 Public Property Get wellName(I)
   wellName = readByName(rng_wellName, I)
 End Property
'============================================
 
' параметры конструкции скважины
 Public Property Let Hvd_m(I, Val)
    Call writeByName(rng_Hvd_m, I, Val)
 End Property
 
 Public Property Get Hvd_m(I)
   Hvd_m = readByName(rng_Hvd_m, I)
 End Property
'============================================
 
 Public Property Let UdlHvd_m(I, Val)
    Call writeByName(rng_UdlHvd_m, I, Val)
 End Property
 
 Public Property Get UdlHvd_m(I)
   UdlHvd_m = readByName(rng_UdlHvd_m, I)
 End Property
'============================================
 
 Public Property Let hpump_m(I, Val)
    Call writeByName(rng_hpump_m, I, Val)
 End Property
 
 Public Property Get hpump_m(I)
   hpump_m = readByName(rng_hpump_m, I)
 End Property
'============================================
 
 Public Property Let UdlHpump_m(I, Val)
    Call writeByName(rng_UdlHpump_m, I, Val)
 End Property
 
 Public Property Get UdlHpump_m(I)
   UdlHpump_m = readByName(rng_UdlHpump_m, I)
 End Property
'============================================
 
 Public Property Let d_cas_mm(I, Val)
    Call writeByName(rng_d_cas_mm, I, Val)
 End Property
 
 Public Property Get d_cas_mm(I)
   d_cas_mm = readByName(rng_d_cas_mm, I)
 End Property
'============================================
 
 Public Property Let dtub_mm(I, Val)
    Call writeByName(rng_dtub_mm, I, Val)
 End Property
 
 Public Property Get dtub_mm(I)
   dtub_mm = readByName(rng_dtub_mm, I)
 End Property
'============================================
 
 Public Property Let dchoke_mm(I, Val)
    Call writeByName(rng_dchoke_mm, I, Val)
 End Property
 Public Property Get dchoke_mm(I)
   dchoke_mm = readByName(rng_dchoke_mm, I)
 End Property
'============================================
    
Public Property Let Pint_atma(I, Val)
    Call writeByName(rng_Pint_atma, I, Val)
End Property
 Public Property Get Pint_atma(I)
   Pint_atma = readByName(rng_Pint_atma, I)
 End Property
'============================================
Public Property Let pbuf_atma(I, Val)
    Call writeByName(rng_pbuf_atma, I, Val)
End Property
Public Property Get pbuf_atma(I)
   pbuf_atma = readByName(rng_pbuf_atma, I)
End Property
'============================================
Public Property Let Pann_atma(I, Val)
    Call writeByName(rng_Pann_atma, I, Val)
End Property
Public Property Get Pann_atma(I)
   Pann_atma = readByName(rng_Pann_atma, I)
End Property
'============================================
Public Property Let Pline_atma(I, Val)
    Call writeByName(rng_Pline_atma, I, Val)
End Property
 Public Property Get Pline_atma(I)
   Pline_atma = readByName(rng_Pline_atma, I)
 End Property
'============================================
Public Property Let Pdis_atma(I, Val)
    Call writeByName(rng_Pdis_atma, I, Val)
End Property
 Public Property Get Pdis_atma(I)
   Pdis_atma = readByName(rng_Pdis_atma, I)
 End Property
'============================================
Public Property Let Hdyn_m(I, Val)
    Call writeByName(rng_Hdyn_m, I, Val)
End Property
 
 Public Property Get Hdyn_m(I)
   Hdyn_m = readByName(rng_Hdyn_m, I)
 End Property
'============================================
 Public Property Let UdlHdyn_m(I, Val)
    Call writeByName(rng_UdlHdyn_m, I, Val)
 End Property
 Public Property Get UdlHdyn_m(I)
   UdlHdyn_m = readByName(rng_UdlHdyn_m, I)
 End Property
'============================================
    ' замеры по работе скважины
 Public Property Let qliq_m3day(I, Val)
    Call writeByName(rng_qliq_m3day, I, Val)
 End Property
 Public Property Get qliq_m3day(I)
   qliq_m3day = readByName(rng_qliq_m3day, I)
 End Property
'============================================
 Public Property Let Qoil_tday(I, Val)
    Call writeByName(rng_Qoil_tday, I, Val)
 End Property
 Public Property Get Qoil_tday(I)
   Qoil_tday = readByName(rng_Qoil_tday, I)
 End Property
'============================================
    Public Property Let fw_perc(I, Val)
    Call writeByName(rng_fw_perc, I, Val)
    
    End Property
 Public Property Get fw_perc(I)
   fw_perc = readByName(rng_fw_perc, I)
 End Property
'============================================
    ' PVT
 Public Property Let GOR_m3m3(I, Val)
    Call writeByName(rng_GOR_m3m3, I, Val)
 End Property
 Public Property Get GOR_m3m3(I)
   GOR_m3m3 = readByName(rng_GOR_m3m3, I)
 End Property
'============================================
 Public Property Let rs_m3m3(I, Val)
    Call writeByName(rng_Rs_m3m3, I, Val)
 End Property
 Public Property Get rs_m3m3(I)
   rs_m3m3 = readByName(rng_Rs_m3m3, I)
 End Property
'============================================
 Public Property Let pb_atma(I, Val)
    Call writeByName(rng_pb_atma, I, Val)
 End Property
 Public Property Get pb_atma(I)
   pb_atma = readByName(rng_pb_atma, I)
 End Property
'============================================
 Public Property Let bob_m3m3(I, Val)
    Call writeByName(rng_bob_m3m3, I, Val)
 End Property
 Public Property Get bob_m3m3(I)
   bob_m3m3 = readByName(rng_bob_m3m3, I)
 End Property
'============================================
 Public Property Let tres_C(I, Val)
    Call writeByName(rng_tres_C, I, Val)
 End Property
 Public Property Get tres_C(I)
   tres_C = readByName(rng_tres_C, I)
 End Property
'============================================
 Public Property Let MubOil_cP(I, Val)
    Call writeByName(rng_MubOil_cP, I, Val)
 End Property
 Public Property Get MubOil_cP(I)
   MubOil_cP = readByName(rng_MubOil_cP, I)
 End Property
'============================================
 Public Property Let rho_oil_sckgm3(I, Val)
    Call writeByName(rng_rho_oil_sckgm3, I, Val)
 End Property
 Public Property Get rho_oil_sckgm3(I)
   rho_oil_sckgm3 = readByName(rng_rho_oil_sckgm3, I)
 End Property
'============================================
 Public Property Let gammaOil(I, Val)
    Call writeByName(rng_rho_oil_sckgm3, I, Val)
 End Property
 Public Property Get gammaOil(I)
   gammaOil = readByName(rng_gammaOil, I)
 End Property
'============================================
 Public Property Let gammaWater(I, Val)
    Call writeByName(rng_rho_oil_sckgm3, I, Val)
 End Property
 Public Property Get gammaWater(I)
   gammaWater = readByName(rng_gammaWater, I)
 End Property
'============================================
'============================================
' доля времени работы скважины на ПКВ - в тех режиме хранится время работы в сутки
 Public Property Let PKV_work_hrday(I, Val)
    Call writeByName(rng_PKV_work_hrday, I, Val)
 End Property
 Public Property Get PKV_work_hrday(I)
   PKV_work_hrday = readByName(rng_PKV_work_hrday, I)
 End Property
'============================================
 ' параметры для выводв для анализа КПД ДВА
  Public Property Let out_PKV_time_frac(I, Val)
    Call writeByName(outRng_PKV_time_frac, I, Val)
  End Property
 Public Property Get out_PKV_time_frac(I)
   out_PKV_time_frac = readByName(outRng_PKV_time_frac, I)
 End Property
'============================================
  Public Property Let out_QliqInst_m3day(I, Val)    ' мгновенный дебит скважины
    Call writeByName(outRng_QliqInst_m3day, I, Val)
  
  End Property
 Public Property Get out_QliqInst_m3day(I)
   out_QliqInst_m3day = readByName(outRng_QliqInst_m3day, I)
 End Property
'============================================
  Public Property Let out_fw_frac(I, Val)
    Call writeByName(outRng_fw_frac, I, Val)
  
  End Property
 Public Property Get out_fw_frac(I)
   out_fw_frac = readByName(outRng_fw_frac, I)
 End Property
'============================================
  Public Property Let out_pbuf_atma(I, Val)
    Call writeByName(outRng_pbuf_atma, I, Val)
  
  End Property
 Public Property Get out_pbuf_atma(I)
   out_pbuf_atma = readByName(outRng_pbuf_atma, I)
 End Property
'============================================
  Public Property Let out_pwf_atma(I, Val)
    Call writeByName(outRng_pwf_atma, I, Val)
  
  End Property
 Public Property Get out_pwf_atma(I)
   out_pwf_atma = readByName(outRng_pwf_atma, I)
 End Property
'============================================
  Public Property Let out_Pint_atma(I, Val)
    Call writeByName(outRng_Pint_atma, I, Val)
  
  End Property
 Public Property Get out_Pint_atma(I)
   out_Pint_atma = readByName(outRng_Pint_atma, I)
 End Property
'============================================
  Public Property Let out_Tintake_C(I, Val)
    Call writeByName(outRng_Tintake_C, I, Val)
  
  End Property
 Public Property Get out_Tintake_C(I)
   out_Tintake_C = readByName(outRng_Tintake_C, I)
 End Property
'============================================
  Public Property Let out_Ksepnat_frac(I, Val)
    Call writeByName(outRng_Ksepnat_frac, I, Val)
  
  End Property
 Public Property Get out_Ksepnat_frac(I)
   out_Ksepnat_frac = readByName(outRng_Ksepnat_frac, I)
 End Property
'============================================
  Public Property Let out_KsepGS_frac(I, Val)
    Call writeByName(outRng_KsepGS_frac, I, Val)
  
  End Property
 Public Property Get out_KsepGS_frac(I)
   out_KsepGS_frac = readByName(outRng_KsepGS_frac, I)
 End Property
'============================================
  Public Property Let out_GasFrac_frac(I, Val)
    Call writeByName(outRng_GasFrac_frac, I, Val)
  
  End Property
 Public Property Get out_GasFrac_frac(I)
   out_GasFrac_frac = readByName(outRng_GasFrac_frac, I)
 End Property
'============================================
  Public Property Let out_Pdis_atma(I, Val)
    Call writeByName(outRng_Pdis_atma, I, Val)
  
  End Property
 Public Property Get out_Pdis_atma(I)
   out_Pdis_atma = readByName(outRng_Pdis_atma, I)
 End Property
'============================================
  Public Property Let out_Tdis_C(I, Val)
    Call writeByName(outRng_Tdis_C, I, Val)
  
  End Property
 Public Property Get out_Tdis_C(I)
   out_Tdis_C = readByName(outRng_Tdis_C, I)
 End Property
'============================================
  Public Property Let out_QmixIntake_m3day(I, Val)
    Call writeByName(outRng_QmixIntake_m3day, I, Val)
  
  End Property
 Public Property Get out_QmixIntake_m3day(I)
   out_QmixIntake_m3day = readByName(outRng_QmixIntake_m3day, I)
 End Property
'============================================
  Public Property Let out_QmixDis_m3day(I, Val)
    Call writeByName(outRng_QmixDis_m3day, I, Val)
  
  End Property
 Public Property Get out_QmixDis_m3day(I)
   out_QmixDis_m3day = readByName(outRng_QmixDis_m3day, I)
 End Property
'============================================
  Public Property Let out_QmixAv_m3day(I, Val)
    Call writeByName(outRng_QmixAv_m3day, I, Val)
  
  End Property
 Public Property Get out_QmixAv_m3day(I)
   out_QmixAv_m3day = readByName(outRng_QmixAv_m3day, I)
 End Property
'============================================
  Public Property Let out_Ngidr_kW(I, Val)
    Call writeByName(outRng_Ngidr_kW, I, Val)
  
  End Property
 Public Property Get out_Ngidr_kW(I)
   out_Ngidr_kW = readByName(outRng_Ngidr_kW, I)
 End Property
'============================================
  Public Property Let out_Nelctric_kW(I, Val)
    Call writeByName(outRng_Nelctric_kW, I, Val)
  
  End Property
 Public Property Get out_Nelctric_kW(I)
   out_Nelctric_kW = readByName(outRng_Nelctric_kW, I)
 End Property
'============================================
  Public Property Let out_KPD_frac(I, Val)
    Call writeByName(outRng_KPD_frac, I, Val)
  
  End Property
 Public Property Get out_KPD_frac(I)
   out_KPD_frac = readByName(outRng_KPD_frac, I)
 End Property
'============================================
'============================================
  Public Property Let Nelectric_kwhrday(I, Val)
    Call writeByName(rng_Nelectric_kwhrday, I, Val)
  
  End Property
 Public Property Get Nelectric_kwhrday(I)
   Nelectric_kwhrday = readByName(rng_Nelectric_kwhrday, I)
 End Property
'============================================
  Public Property Let msg(I, Val)
    Call writeByName(outRng_msg, I, Val)
  
  End Property
