' Расчет перепада давления в штуцере (по потоку)
Public Function MF_dPChoke_atm(dPipe_mm, dchoke_mm, _
            Pin_atma, Pout_atma, _
            Qliq_m3day, fw_perc, _
            Optional ByVal Tchoke_C As Double = 20, _
            Optional ByVal Calc_from_P0 As Boolean = True, _
            Optional ByVal PVTstr As String = PVT_DEFAULT)
            
On Error GoTo err1:
    Dim PT
    Dim dPT(2) As Double
    
    PT = MF_PChoke_atm(dPipe_mm, dchoke_mm, _
            Pin_atma, Pout_atma, _
            Qliq_m3day, fw_perc, _
            Tchoke_C, _
            Calc_from_P0, _
            PVTstr)
    If Calc_from_P0 Then
        dPT(0) = Pin_atma - PT(0)
    Else
        dPT(0) = PT(0) - Pout_atma
    End If
    dPT(1) = PT(1) - Tchoke_C
    
    MF_dPChoke_atm = dPT
    
    Exit Function
err1:
    MF_dPChoke_atm = "error"
    addLogMsg "error in function : MF_dPChoke_atm"
End Function
' расчет давления в штуцере
