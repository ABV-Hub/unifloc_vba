 Public Function Well_calcKdegr_fr(Pwf_atma, Pbuf_atma, Q_m3Day, _
                      Optional ByVal Hperf_m = 2500, Optional ByVal Hpump_m = 2000, Optional ByVal Udl_m = 0, Optional ByVal dCas_mm = 127, Optional ByVal dTub_mm = 62, Optional ByVal dchoke_mm = -1, _
                      Optional ByVal fw_perc = 0, Optional ByVal Rp_m3m3 As Double = -1, Optional ByVal rsb_m3m3 As Double = 100, Optional ByVal Pb_atma As Double = -1, Optional ByVal Tres_C As Double = 90, _
                      Optional ByVal gamma_oil As Double = const_gamma_oil_default, Optional ByVal gamma_wat As Double = const_gamma_wat_default, Optional ByVal gamma_gas As Double = const_gamma_gas_default, _
                      Optional ByVal Bob_m3m3 As Double = -1, Optional ByVal Twh_C As Double = 10, Optional ByVal Tbh_C As Double = 80, _
                      Optional ByVal roughness_m As Double = 0.0001, _
                      Optional ByVal ESP_ID = 0, Optional ByVal ESP_numStages = 0, Optional ByVal ESP_freq_Hz = 50, _
                      Optional ByVal PVTcorr As PVT_CORRELATION = 0, Optional ByVal HydrCorr As H_CORRELATION = 0, Optional ByVal Ksep_fr As Double = 0)
' функция расчета линейного давления скважины по забойному
'    Dim well As CWellESP
'    Set well = InitWellData(Q_m3Day, _
'                       Hperf_m, Hpump_m, Udl_m, dCas_mm, dTub_mm, dchoke_mm, _
'                       fw_perc, Rp_m3m3, rsb_m3m3, Pb_atma, Tres_C, _
'                       gamma_oil, gamma_wat, gamma_gas, _
'                       Bob_m3m3, Twh_C, Tbh_C, _
'                       roughness_m, _
'                       ESP_ID, ESP_numStages, ESP_freq_Hz, _
'                       PVTcorr, HydrCorr, Ksep_fr)
''    Set well.Pbuf_atma = Pbuf_atma
'    Call well.Calc_Well(Pbuf_atma, Pbuf_atma, Pwf_atma, Tbh_C, CalcChoke:=False)
''    Call well.fin(SetPT(Pwf_atma, Tbh_C))     ' проведем расчет
''    Call well.Calc_Plin_Pwf_atma(SetPT(Pwf_atma, Tbh_C))     ' проведем расчет
'    ' в качестве результата выведем рад расчитанных значений давления
'    With well
'        Well_calcKdegr_fr = Array(Array(.ESP.cfHead_fr, .Pline_atma, .Pbuf_atma, .Pdis_atma, .Pint_atma, .Pwf_atma, "деградация ЭЦН ,Давления атм, линейное, буферное, на приеме насоса, на выкиде насоса, забойное"), _
'                                  Array(.Kseptotal_d, .Tsurf_C, .Twh_C, .Tdis_C, .Tint_C, .Tbh_C, "Ксеп,Температура С, на поверхности, буферное, на приеме насоса, на выкиде насоса, забойное"))
'    ' можно еще добавить сюда вывод кривых распределения давления и температуры по стволу и еще 4 параметров  (потом)
'    End With
