 Public Function ESP_dP_atm(Qliq_m3day As Double, fw_perc As Double, _
                        P_atma As Double, _
                        Optional ByVal NumStages As Integer = 1, Optional ByVal freq_Hz As Double = 50, _
                        Optional ByVal PumpID = 674, _
                        Optional ByVal gamma_gas As Double = const_gamma_gas_default, _
                        Optional ByVal gamma_oil As Double = const_gamma_oil_default, _
                        Optional ByVal gamma_wat As Double = const_gamma_wat_default, _
                        Optional ByVal rsb_m3m3 = const_Rsb_default, _
                        Optional ByVal Rp_m3m3 As Double = -1, _
                        Optional ByVal Pb_atma As Double = -1, _
                        Optional ByVal Tres_C As Double = const_Tres_default, _
                        Optional ByVal Bob_m3m3 As Double = -1, _
                        Optional ByVal Muob_cP As Double = -1, _
                        Optional ByVal PVTcorr = StandingBased, _
                        Optional ByVal Ksep_fr As Double = 0, _
                        Optional ByVal PKsep_atma As Double = -1, _
                        Optional ByVal TKsep_C As Double = -1, _
                        Optional ByVal Tin_C As Double = 50, _
                        Optional ByVal Tdis_C As Double = 50, _
                        Optional ByVal CalcFromIntake As Boolean = 1)
' расчет перепада давления в насосе при перекачке ГЖС с заданными
' характеристиками (харктеристики фдюида для поверхности берутся)
' простая версия с полным заданием PVT свойств флюида
' Qliq_m3day        - дебит жидкости на поверхности
' fw_perc           - обводненность
' Pin_atma          - давление на приеме насоса
' Pout_atma         - давление на выкиде насоса, используется для расчета
'                     сверху вниз и для расчета деградации насоса. при расчете снизу вверх игнор
' NumStages         - количество ступеней
' freq_Hz           - частота, Гц
' PumpID            - идентификатор насоса
' PVT               - набор данных PVT
' Tin_C             - температура на приеме насоа
' Tdis_C            - температура на выкиде насоса. если =0 и CalcFromIntake = 1 то рассчитывается
' CalcFromIntake    - режим расчета снизу вверх или сверху вниз
' GasDegtType       - тип насоса по работе с газом
' Kdegr             - коэффициент деградации напора
' режимы расчета ЭЦН
'       1 - расчет от давления на приеме вверх - флюид задан
'       2 - расчет от давление на выходе вниз - флюид и сепарация задан (быстрый расчет)
'       3 - расчет от давления на выходе вниз - флюид задан, сепарация определяется
'       4 - расчет деградации по значениям давления на приеме и на выходе
'
