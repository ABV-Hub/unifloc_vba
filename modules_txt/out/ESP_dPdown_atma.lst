 'Public Function ESP_dPdown_atma(Pin_atma As Double, Qliq_m3day As Double, Optional  Byval Ksep_fr As Double = 0, Optional  Byval NumStages As Integer = 1, Optional  Byval freq_Hz As Double = 50, Optional  Byval PumpID = 674, _
'                      Optional  Byval fw_perc As Double = 0, Optional  Byval Rp_m3m3 As Double = -1, Optional  Byval rsb_m3m3 As Double = 100, Optional  Byval Pb_atma As Double = -1, Optional  Byval Tres_C As Double = 90, _
'                      Optional  Byval gamma_oil as double = const_gamma_oil_default, Optional  Byval gamma_wat as double = const_gamma_wat_default, Optional  Byval gamma_gas as double = const_gamma_gas_default, _
'                      Optional  Byval Bob_m3m3 As Double = -1, Optional  Byval Tin_C As Double = 50, Optional  Byval Tout_C As Double = 50, _
'                      Optional  Byval PVTcorr As PVT_CORRELATION = 0, Optional  Byval CalcFromIntake As Integer = 1, _
'                      Optional  Byval GasDegtType As Integer = 0, Optional  Byval Kdegr As Double = 0)
''  расчет перепада давления в насосе при перекачке ГЖС с заданнвми характеристиками (харктеристики фдюида для поверхности берутся)
''
'    Dim PTup As PTtype
'    If Not checkID(PumpID) Then
'        ESP_dPdown_atma = 0
'        Exit Function
'    End If
'    Dim Fluid As New CPVT
'    Call Fluid.SetRpRsb(Rp_m3m3, rsb_m3m3)
'    Fluid.Pb_atma = Pb_atma
'    Fluid.Tres_C = Tres_C
'    Fluid.PVT_CORRELATION = PVTcorr
'    Fluid.Bob_m3m3 = Bob_m3m3
'    Fluid.gamma_g = gamma_gas
'    Fluid.gamma_o = gamma_oil
'    Fluid.gamma_w = gamma_wat
'    Fluid.Qliq_scm3day = Qliq_m3day
'    Fluid.wc_perc = fw_perc
'
''   Dim fluidESP As CPVT
''   Ksep_fr = 0.5
'
'    Call Fluid.ModAfterSeparation(Pin_atma, Tin_C, Ksep_fr, GasnotGoesIntoSolution)
'    Set ESP.Fluid = Fluid 'ESP
'
'    ESP.ESPtype = GasDegtType
'    ESP.freq_Hz = freq_Hz
'    ESP.StageNum = NumStages
'    ESP.PressureDegradation = Kdegr
'  '  ESP_dP_atma = ESP.Calc_ESP_dP_atma(Pin_atma, Ksep_fr, Tin_C, CalcFromIntake)
'   ' Call
'    PTup.P_atma = Pin_atma
'    PTup.T_C = Tin_C + 20
'    ESP_dPdown_atma = Pin_atma - ESP.Calc_ESP_UpDown(PTup, Tin_C).P_atma  'ESP.Pdis_atma
'End Function
'
'--------------------- Двигатель -----------------------
'' функция загрузки параметров двигателя с листа
