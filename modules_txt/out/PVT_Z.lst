' расчет коэффициента сверхсжимаемости газа
Public Function PVT_Z(P_atma, T_C, _
                    Optional ByVal gamma_gas As Double = const_gamma_gas_default, _
                    Optional ByVal gamma_oil As Double = const_gamma_oil_default, _
                    Optional ByVal gamma_wat As Double = const_gamma_wat_default, _
                    Optional ByVal rsb_m3m3 = const_Rsb_default, _
                    Optional ByVal Rp_m3m3 = -1, _
                    Optional ByVal Pb_atma = -1, _
                    Optional ByVal Tres_C = const_Tres_default, _
                    Optional ByVal Bob_m3m3 = -1, _
                    Optional ByVal Muob_cP = -1, _
                    Optional ByVal PVTcorr = StandingBased, _
                    Optional ByVal Ksep_fr = 0, _
                    Optional ByVal PKsep_atma = -1, _
                    Optional ByVal TKsep_C = -1, _
                    Optional ByVal PVTstr As String = "" _
                    ) As Double
' обязательные аргументы функции
' P_atma    давление, атм
' Т_C       температура, С.
'
' опциональные аргументы функции
' gamma_gas удельная плотность газа, по воздуху.
'           const_gamma_gas_default = 0.6
' gamma_oil удельная плотность нефти, по воде.
'           const_gamma_oil_default = 0.86
' gamma_wat удельная плотность воды, по воде.
'           const_gamma_wat_default = 1
' Rsb_m3m3  газосодержание при давлении насыщения, м3/м3.
'           const_Rsb_default = 100
' Rp_m3m3   замерной газовый фактор, м3/м3.
'           имеет приоритет перед Rsb если Rp < Rsb
' Pb_atma   Давление насыщения при  температуре Tres_C, атма.
'           Опциональный калибровочный параметр,
'           если не задан или = 0 то рассчитается по корреляции
' Tres_C    пластовая температура, С.
'           Учитывается при расчете давления насыщения.
'           const_Tres_default = 90
' Bob_m3m3  объемный коэффициент нефти, м3/м3.
' Muob_cP   вязкость нефти при давлении насыщения
'           По умолчанию рассчитывается по корреляции
' PVTcorr   номер набора PVT корреляций для расчета
'           StandingBased = 0 - на основе кор-ии Стендинга
'           McCainBased = 1 - на основе кор-ии Маккейна
'           StraigthLine = 2 - на основе упрощенных зависимостей
' Ksep_fr   коэффициент сепарации - определяет изменение свойств
'           нефти после сепарации доли свободного газа.
'           изменение свойств нефти зависит от условий
'           сепарации газа, которые должны быть явно заданы
' PKsep_atma    давление при которой была сепарация
' TKsep_C       температура при которой была сепарация
' PVTstr    закодированная строка с параметрами PVT.
'           если задана - перекрывает другие значения
'
' выходное значение - число - z фактор газа.
'           коэффициент сверхсжимаемости газа,
'           безразмерная величина
