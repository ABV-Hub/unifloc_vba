''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
'Copyright (c) 2007, Sergey Bochkanov (ALGLIB project).
'
'>>> SOURCE LICENSE >>>
'This program is free software; you can redistribute it and/or modify
'it under the terms of the GNU General Public License as published by
'the Free Software Foundation (www.fsf.org); either version 2 of the
'License, or (at your option) any later version.
'
'This program is distributed in the hope that it will be useful,
'but WITHOUT ANY WARRANTY; without even the implied warranty of
'MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
'GNU General Public License for more details.
'
'A copy of the GNU General Public License is available at
'http://www.fsf.org/licensing/licenses
'
'>>> END OF LICENSE >>>
''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
'Routines
''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
'Jarque-Bera test
'
'This test checks hypotheses about the fact that a  given  sample  X  is  a
'sample of normal random variable.
'
'Requirements:
'    * the number of elements in the sample is not less than 5.
'
'Input parameters:
'    X   -   sample. Array whose index goes from 0 to N-1.
'    N   -   size of the sample. N>=5
'
'Output parameters:
'    BothTails   -   p-value for two-tailed test.
'                    If BothTails is less than the given significance level
'                    the null hypothesis is rejected.
'    LeftTail    -   p-value for left-tailed test.
'                    If LeftTail is less than the given significance level,
'                    the null hypothesis is rejected.
'    RightTail   -   p-value for right-tailed test.
'                    If RightTail is less than the given significance level
'                    the null hypothesis is rejected.
'
'Accuracy of the approximation used (5<=N<=1951):
'
'p-value            relative error (5<=N<=1951)
'[1, 0.1]            < 1%
'[0.1, 0.01]         < 2%
'[0.01, 0.001]       < 6%
'[0.001, 0]          wasn't measured
'
'For N>1951 accuracy wasn't measured but it shouldn't be sharply  different
'from table values.
'
'  -- ALGLIB --
'     Copyright 09.04.2007 by Bochkanov Sergey
'
''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
Public Sub JarqueBeraTest(ByRef X() As Double, _
         ByVal N As Long, _
         ByRef p As Double)
    Dim S As Double
    
    '
    ' N is too small
    '
    If N < 5# Then
        p = 1#
        Exit Sub
    End If
    
    '
    ' N is large enough
    '
    Call JarqueBeraStatistic(X, N, S)
    p = JarqueBeraApprox(N, S)
End Sub
Private Sub JarqueBeraStatistic(ByRef X() As Double, _
         ByVal N As Long, _
         ByRef S As Double)
    Dim i As Long
    Dim V As Double
    Dim V1 As Double
    Dim V2 As Double
    Dim StdDev As Double
    Dim Mean As Double
    Dim Variance As Double
    Dim Skewness As Double
    Dim Kurtosis As Double
    Mean = 0#
    Variance = 0#
    Skewness = 0#
    Kurtosis = 0#
    StdDev = 0#
    
    '
    ' Mean
    '
    For i = 0# To N - 1# Step 1
        Mean = Mean + X(i)
    Next i
    Mean = Mean / N
    
    '
    ' Variance (using corrected two-pass algorithm)
    '
    If N <> 1# Then
        V1 = 0#
        For i = 0# To N - 1# Step 1
            V1 = V1 + Square(X(i) - Mean)
        Next i
        V2 = 0#
        For i = 0# To N - 1# Step 1
            V2 = V2 + (X(i) - Mean)
        Next i
        V2 = Square(V2) / N
        Variance = (V1 - V2) / (N - 1#)
        If Variance < 0# Then
            Variance = 0#
        End If
        StdDev = Sqr(Variance)
    End If
    
    '
    ' Skewness and kurtosis
    '
    If StdDev <> 0# Then
        For i = 0# To N - 1# Step 1
            V = (X(i) - Mean) / StdDev
            V2 = Square(V)
            Skewness = Skewness + V2 * V
            Kurtosis = Kurtosis + Square(V2)
        Next i
        Skewness = Skewness / N
        Kurtosis = Kurtosis / N - 3#
    End If
    
    '
    ' Statistic
    '
    S = N / 6# * (Square(Skewness) + Square(Kurtosis) / 4#)
End Sub
Private Function JarqueBeraApprox(ByVal N As Long, ByVal S As Double) As Double
    Dim Result As Double
    Dim VX() As Double
    Dim VY() As Double
    Dim ctbl() As Double
    Dim T1 As Double
    Dim T2 As Double
    Dim T3 As Double
    Dim T As Double
    Dim F1 As Double
    Dim F2 As Double
    Dim F3 As Double
    Dim F12 As Double
    Dim F23 As Double
    Dim X As Double
    Result = 1#
    X = S
    If N < 5# Then
        JarqueBeraApprox = Result
        Exit Function
    End If
    
    '
    ' N = 5..20 are tabulated
    '
    If N >= 5# And N <= 20# Then
        If N = 5# Then
            Result = Exp(JBTbl5(X))
        End If
        If N = 6# Then
            Result = Exp(JBTbl6(X))
        End If
        If N = 7# Then
            Result = Exp(JBTbl7(X))
        End If
        If N = 8# Then
            Result = Exp(JBTbl8(X))
        End If
        If N = 9# Then
            Result = Exp(JBTbl9(X))
        End If
        If N = 10# Then
            Result = Exp(JBTbl10(X))
        End If
        If N = 11# Then
            Result = Exp(JBTbl11(X))
        End If
        If N = 12# Then
            Result = Exp(JBTbl12(X))
        End If
        If N = 13# Then
            Result = Exp(JBTbl13(X))
        End If
        If N = 14# Then
            Result = Exp(JBTbl14(X))
        End If
        If N = 15# Then
            Result = Exp(JBTbl15(X))
        End If
        If N = 16# Then
            Result = Exp(JBTbl16(X))
        End If
        If N = 17# Then
            Result = Exp(JBTbl17(X))
        End If
        If N = 18# Then
            Result = Exp(JBTbl18(X))
        End If
        If N = 19# Then
            Result = Exp(JBTbl19(X))
        End If
        If N = 20# Then
            Result = Exp(JBTbl20(X))
        End If
        JarqueBeraApprox = Result
        Exit Function
    End If
    
    '
    ' N = 20, 30, 50 are tabulated.
    ' In-between values are interpolated
    ' using interpolating polynomial of the second degree.
    '
    If N > 20# And N <= 50# Then
        T1 = -(1# / 20#)
        T2 = -(1# / 30#)
        T3 = -(1# / 50#)
        T = -(1# / N)
        F1 = JBTbl20(X)
        F2 = JBTbl30(X)
        F3 = JBTbl50(X)
        F12 = ((T - T2) * F1 + (T1 - T) * F2) / (T1 - T2)
        F23 = ((T - T3) * F2 + (T2 - T) * F3) / (T2 - T3)
        Result = ((T - T3) * F12 + (T1 - T) * F23) / (T1 - T3)
        If Result > 0# Then
            Result = 0#
        End If
        Result = Exp(Result)
        JarqueBeraApprox = Result
        Exit Function
    End If
    
    '
    ' N = 50, 65, 100 are tabulated.
    ' In-between values are interpolated
    ' using interpolating polynomial of the second degree.
    '
    If N > 50# And N <= 100# Then
        T1 = -(1# / 50#)
        T2 = -(1# / 65#)
        T3 = -(1# / 100#)
        T = -(1# / N)
        F1 = JBTbl50(X)
        F2 = JBTbl65(X)
        F3 = JBTbl100(X)
        F12 = ((T - T2) * F1 + (T1 - T) * F2) / (T1 - T2)
        F23 = ((T - T3) * F2 + (T2 - T) * F3) / (T2 - T3)
        Result = ((T - T3) * F12 + (T1 - T) * F23) / (T1 - T3)
        If Result > 0# Then
            Result = 0#
        End If
        Result = Exp(Result)
        JarqueBeraApprox = Result
        Exit Function
    End If
    
    '
    ' N = 100, 130, 200 are tabulated.
    ' In-between values are interpolated
    ' using interpolating polynomial of the second degree.
    '
    If N > 100# And N <= 200# Then
        T1 = -(1# / 100#)
        T2 = -(1# / 130#)
        T3 = -(1# / 200#)
        T = -(1# / N)
        F1 = JBTbl100(X)
        F2 = JBTbl130(X)
        F3 = JBTbl200(X)
        F12 = ((T - T2) * F1 + (T1 - T) * F2) / (T1 - T2)
        F23 = ((T - T3) * F2 + (T2 - T) * F3) / (T2 - T3)
        Result = ((T - T3) * F12 + (T1 - T) * F23) / (T1 - T3)
        If Result > 0# Then
            Result = 0#
        End If
        Result = Exp(Result)
        JarqueBeraApprox = Result
        Exit Function
    End If
    
    '
    ' N = 200, 301, 501 are tabulated.
    ' In-between values are interpolated
    ' using interpolating polynomial of the second degree.
    '
    If N > 200# And N <= 501# Then
        T1 = -(1# / 200#)
        T2 = -(1# / 301#)
        T3 = -(1# / 501#)
        T = -(1# / N)
        F1 = JBTbl200(X)
        F2 = JBTbl301(X)
        F3 = JBTbl501(X)
        F12 = ((T - T2) * F1 + (T1 - T) * F2) / (T1 - T2)
        F23 = ((T - T3) * F2 + (T2 - T) * F3) / (T2 - T3)
        Result = ((T - T3) * F12 + (T1 - T) * F23) / (T1 - T3)
        If Result > 0# Then
            Result = 0#
        End If
        Result = Exp(Result)
        JarqueBeraApprox = Result
        Exit Function
    End If
    
    '
    ' N = 501, 701, 1401 are tabulated.
    ' In-between values are interpolated
    ' using interpolating polynomial of the second degree.
    '
    If N > 501# And N <= 1401# Then
        T1 = -(1# / 501#)
        T2 = -(1# / 701#)
        T3 = -(1# / 1401#)
        T = -(1# / N)
        F1 = JBTbl501(X)
        F2 = JBTbl701(X)
        F3 = JBTbl1401(X)
        F12 = ((T - T2) * F1 + (T1 - T) * F2) / (T1 - T2)
        F23 = ((T - T3) * F2 + (T2 - T) * F3) / (T2 - T3)
        Result = ((T - T3) * F12 + (T1 - T) * F23) / (T1 - T3)
        If Result > 0# Then
            Result = 0#
        End If
        Result = Exp(Result)
        JarqueBeraApprox = Result
        Exit Function
    End If
    
    '
    ' Asymptotic expansion
    '
    If N > 1401# Then
        Result = -(0.5 * X) + (JBTbl1401(X) + 0.5 * X) * Sqr(1401# / N)
        If Result > 0# Then
            Result = 0#
        End If
        Result = Exp(Result)
        JarqueBeraApprox = Result
        Exit Function
    End If
    JarqueBeraApprox = Result
End Function
Private Function JBTbl5(ByVal S As Double) As Double
    Dim Result As Double
    Dim X As Double
    Dim TJ As Double
    Dim TJ1 As Double
    Result = 0#
    If S <= 0.4 Then
        X = 2# * (S - 0#) / 0.4 - 1#
        TJ = 1#
        TJ1 = X
        Call JBCheb(X, -1.097885E-20, TJ, TJ1, Result)
        Call JBCheb(X, -2.854501E-20, TJ, TJ1, Result)
        Call JBCheb(X, -1.756616E-20, TJ, TJ1, Result)
        If Result > 0# Then
            Result = 0#
        End If
        JBTbl5 = Result
        Exit Function
    End If
    If S <= 1.1 Then
        X = 2# * (S - 0.4) / 0.7 - 1#
        TJ = 1#
        TJ1 = X
        Call JBCheb(X, -1.324545, TJ, TJ1, Result)
        Call JBCheb(X, -1.075941, TJ, TJ1, Result)
        Call JBCheb(X, -0.9772272, TJ, TJ1, Result)
        Call JBCheb(X, 0.3175686, TJ, TJ1, Result)
        Call JBCheb(X, -0.1576162, TJ, TJ1, Result)
        Call JBCheb(X, 0.1126861, TJ, TJ1, Result)
        Call JBCheb(X, -0.03434425, TJ, TJ1, Result)
        Call JBCheb(X, -0.2790359, TJ, TJ1, Result)
        Call JBCheb(X, 0.02809178, TJ, TJ1, Result)
        Call JBCheb(X, -0.5479704, TJ, TJ1, Result)
        Call JBCheb(X, 0.0371704, TJ, TJ1, Result)
        Call JBCheb(X, -0.529417, TJ, TJ1, Result)
        Call JBCheb(X, 0.02880632, TJ, TJ1, Result)
        Call JBCheb(X, -0.3023344, TJ, TJ1, Result)
        Call JBCheb(X, 0.01601531, TJ, TJ1, Result)
        Call JBCheb(X, -0.07920403, TJ, TJ1, Result)
        If Result > 0# Then
            Result = 0#
        End If
        JBTbl5 = Result
        Exit Function
    End If
    Result = -(518.8419 * (S - 1.1)) - 4.767297
    JBTbl5 = Result
End Function
Private Function JBTbl6(ByVal S As Double) As Double
    Dim Result As Double
    Dim X As Double
    Dim TJ As Double
    Dim TJ1 As Double
    Result = 0#
    If S <= 0.25 Then
        X = 2# * (S - 0#) / 0.25 - 1#
        TJ = 1#
        TJ1 = X
        Call JBCheb(X, -0.0002274707, TJ, TJ1, Result)
        Call JBCheb(X, -0.0005700471, TJ, TJ1, Result)
        Call JBCheb(X, -0.0003425764, TJ, TJ1, Result)
        If Result > 0# Then
            Result = 0#
        End If
        JBTbl6 = Result
        Exit Function
    End If
    If S <= 1.3 Then
        X = 2# * (S - 0.25) / 1.05 - 1#
        TJ = 1#
        TJ1 = X
        Call JBCheb(X, -1.339, TJ, TJ1, Result)
        Call JBCheb(X, -2.011104, TJ, TJ1, Result)
        Call JBCheb(X, -0.8168177, TJ, TJ1, Result)
        Call JBCheb(X, -0.1085666, TJ, TJ1, Result)
        Call JBCheb(X, 0.07738606, TJ, TJ1, Result)
        Call JBCheb(X, 0.07022876, TJ, TJ1, Result)
        Call JBCheb(X, 0.03462402, TJ, TJ1, Result)
        Call JBCheb(X, 0.00690827, TJ, TJ1, Result)
        Call JBCheb(X, -0.008230772, TJ, TJ1, Result)
        Call JBCheb(X, -0.01006996, TJ, TJ1, Result)
        Call JBCheb(X, -0.005410222, TJ, TJ1, Result)
        Call JBCheb(X, -0.002893768, TJ, TJ1, Result)
        Call JBCheb(X, 0.0008114564, TJ, TJ1, Result)
        If Result > 0# Then
            Result = 0#
        End If
        JBTbl6 = Result
        Exit Function
    End If
    If S <= 1.85 Then
        X = 2# * (S - 1.3) / 0.55 - 1#
        TJ = 1#
        TJ1 = X
        Call JBCheb(X, -6.794311, TJ, TJ1, Result)
        Call JBCheb(X, -3.5787, TJ, TJ1, Result)
        Call JBCheb(X, -1.394664, TJ, TJ1, Result)
        Call JBCheb(X, -0.792829, TJ, TJ1, Result)
        Call JBCheb(X, -0.4813273, TJ, TJ1, Result)
        Call JBCheb(X, -0.3076063, TJ, TJ1, Result)
        Call JBCheb(X, -0.183538, TJ, TJ1, Result)
        Call JBCheb(X, -0.1013013, TJ, TJ1, Result)
        Call JBCheb(X, -0.05058903, TJ, TJ1, Result)
        Call JBCheb(X, -0.01856915, TJ, TJ1, Result)
        Call JBCheb(X, -0.006710887, TJ, TJ1, Result)
        If Result > 0# Then
            Result = 0#
        End If
        JBTbl6 = Result
        Exit Function
    End If
    Result = -(177.0029 * (S - 1.85)) - 13.71015
    JBTbl6 = Result
End Function
Private Function JBTbl7(ByVal S As Double) As Double
    Dim Result As Double
    Dim X As Double
    Dim TJ As Double
    Dim TJ1 As Double
    Result = 0#
    If S <= 1.4 Then
        X = 2# * (S - 0#) / 1.4 - 1#
        TJ = 1#
        TJ1 = X
        Call JBCheb(X, -1.093681, TJ, TJ1, Result)
        Call JBCheb(X, -1.695911, TJ, TJ1, Result)
        Call JBCheb(X, -0.7473192, TJ, TJ1, Result)
        Call JBCheb(X, -0.1203236, TJ, TJ1, Result)
        Call JBCheb(X, 0.06590379, TJ, TJ1, Result)
        Call JBCheb(X, 0.06291876, TJ, TJ1, Result)
        Call JBCheb(X, 0.03132007, TJ, TJ1, Result)
        Call JBCheb(X, 0.009411147, TJ, TJ1, Result)
        Call JBCheb(X, -0.001180067, TJ, TJ1, Result)
        Call JBCheb(X, -0.00348761, TJ, TJ1, Result)
        Call JBCheb(X, -0.002436561, TJ, TJ1, Result)
        If Result > 0# Then
            Result = 0#
        End If
        JBTbl7 = Result
        Exit Function
    End If
    If S <= 3# Then
        X = 2# * (S - 1.4) / 1.6 - 1#
        TJ = 1#
        TJ1 = X
        Call JBCheb(X, -5.947854, TJ, TJ1, Result)
        Call JBCheb(X, -2.772675, TJ, TJ1, Result)
        Call JBCheb(X, -0.4707912, TJ, TJ1, Result)
        Call JBCheb(X, -0.1691171, TJ, TJ1, Result)
        Call JBCheb(X, -0.04132795, TJ, TJ1, Result)
        Call JBCheb(X, -0.0148131, TJ, TJ1, Result)
        Call JBCheb(X, 0.002867536, TJ, TJ1, Result)
        Call JBCheb(X, 0.0008772327, TJ, TJ1, Result)
        Call JBCheb(X, 0.005033387, TJ, TJ1, Result)
        Call JBCheb(X, -0.001378277, TJ, TJ1, Result)
        Call JBCheb(X, -0.002497964, TJ, TJ1, Result)
        Call JBCheb(X, -0.003636814, TJ, TJ1, Result)
        Call JBCheb(X, -0.000958164, TJ, TJ1, Result)
        If Result > 0# Then
            Result = 0#
        End If
        JBTbl7 = Result
        Exit Function
    End If
    If S <= 3.2 Then
        X = 2# * (S - 3#) / 0.2 - 1#
        TJ = 1#
        TJ1 = X
        Call JBCheb(X, -7.511008, TJ, TJ1, Result)
        Call JBCheb(X, -0.8140472, TJ, TJ1, Result)
        Call JBCheb(X, 1.682053, TJ, TJ1, Result)
        Call JBCheb(X, -0.02568561, TJ, TJ1, Result)
        Call JBCheb(X, -1.93393, TJ, TJ1, Result)
        Call JBCheb(X, -0.8140472, TJ, TJ1, Result)
        Call JBCheb(X, -3.895025, TJ, TJ1, Result)
        Call JBCheb(X, -0.8140472, TJ, TJ1, Result)
        Call JBCheb(X, -1.93393, TJ, TJ1, Result)
        Call JBCheb(X, -0.02568561, TJ, TJ1, Result)
        Call JBCheb(X, 1.682053, TJ, TJ1, Result)
        If Result > 0# Then
            Result = 0#
        End If
        JBTbl7 = Result
        Exit Function
    End If
    Result = -(1824.116 * (S - 3.2)) - 14.4033
    JBTbl7 = Result
End Function
Private Function JBTbl8(ByVal S As Double) As Double
    Dim Result As Double
    Dim X As Double
    Dim TJ As Double
    Dim TJ1 As Double
    Result = 0#
    If S <= 1.3 Then
        X = 2# * (S - 0#) / 1.3 - 1#
        TJ = 1#
        TJ1 = X
        Call JBCheb(X, -0.7199015, TJ, TJ1, Result)
        Call JBCheb(X, -1.095921, TJ, TJ1, Result)
        Call JBCheb(X, -0.4736828, TJ, TJ1, Result)
        Call JBCheb(X, -0.1047438, TJ, TJ1, Result)
        Call JBCheb(X, -0.00248432, TJ, TJ1, Result)
        Call JBCheb(X, 0.007937923, TJ, TJ1, Result)
        Call JBCheb(X, 0.00481047, TJ, TJ1, Result)
        Call JBCheb(X, 0.00213978, TJ, TJ1, Result)
        Call JBCheb(X, 0.0006708443, TJ, TJ1, Result)
        If Result > 0# Then
            Result = 0#
        End If
        JBTbl8 = Result
        Exit Function
    End If
    If S <= 2# Then
        X = 2# * (S - 1.3) / 0.7 - 1#
        TJ = 1#
        TJ1 = X
        Call JBCheb(X, -3.378966, TJ, TJ1, Result)
        Call JBCheb(X, -0.7802461, TJ, TJ1, Result)
        Call JBCheb(X, 0.1547593, TJ, TJ1, Result)
        Call JBCheb(X, -0.06241042, TJ, TJ1, Result)
        Call JBCheb(X, 0.01203274, TJ, TJ1, Result)
        Call JBCheb(X, 0.00520199, TJ, TJ1, Result)
        Call JBCheb(X, -0.005125597, TJ, TJ1, Result)
        Call JBCheb(X, 0.001584426, TJ, TJ1, Result)
        Call JBCheb(X, 0.0002546069, TJ, TJ1, Result)
        If Result > 0# Then
            Result = 0#
        End If
        JBTbl8 = Result
        Exit Function
    End If
    If S <= 5# Then
        X = 2# * (S - 2#) / 3# - 1#
        TJ = 1#
        TJ1 = X
        Call JBCheb(X, -6.828366, TJ, TJ1, Result)
        Call JBCheb(X, -3.137533, TJ, TJ1, Result)
        Call JBCheb(X, -0.5016671, TJ, TJ1, Result)
        Call JBCheb(X, -0.1745637, TJ, TJ1, Result)
        Call JBCheb(X, -0.05189801, TJ, TJ1, Result)
        Call JBCheb(X, -0.0162161, TJ, TJ1, Result)
        Call JBCheb(X, -0.006741122, TJ, TJ1, Result)
        Call JBCheb(X, -0.004516368, TJ, TJ1, Result)
        Call JBCheb(X, 0.0003552085, TJ, TJ1, Result)
        Call JBCheb(X, 0.002787029, TJ, TJ1, Result)
        Call JBCheb(X, 0.005359774, TJ, TJ1, Result)
        If Result > 0# Then
            Result = 0#
        End If
        JBTbl8 = Result
        Exit Function
    End If
    Result = -(5.087028 * (S - 5#)) - 10.713
    JBTbl8 = Result
End Function
Private Function JBTbl9(ByVal S As Double) As Double
    Dim Result As Double
    Dim X As Double
    Dim TJ As Double
    Dim TJ1 As Double
    Result = 0#
    If S <= 1.3 Then
        X = 2# * (S - 0#) / 1.3 - 1#
        TJ = 1#
        TJ1 = X
        Call JBCheb(X, -0.627932, TJ, TJ1, Result)
        Call JBCheb(X, -0.9277151, TJ, TJ1, Result)
        Call JBCheb(X, -0.3669339, TJ, TJ1, Result)
        Call JBCheb(X, -0.07086149, TJ, TJ1, Result)
        Call JBCheb(X, -0.001333816, TJ, TJ1, Result)
        Call JBCheb(X, 0.003871249, TJ, TJ1, Result)
        Call JBCheb(X, 0.002007048, TJ, TJ1, Result)
        Call JBCheb(X, 0.0007482245, TJ, TJ1, Result)
        Call JBCheb(X, 0.0002355615, TJ, TJ1, Result)
        If Result > 0# Then
            Result = 0#
        End If
        JBTbl9 = Result
        Exit Function
    End If
    If S <= 2# Then
        X = 2# * (S - 1.3) / 0.7 - 1#
        TJ = 1#
        TJ1 = X
        Call JBCheb(X, -2.98143, TJ, TJ1, Result)
        Call JBCheb(X, -0.7972248, TJ, TJ1, Result)
        Call JBCheb(X, 0.1747737, TJ, TJ1, Result)
        Call JBCheb(X, -0.0380853, TJ, TJ1, Result)
        Call JBCheb(X, -0.007888305, TJ, TJ1, Result)
        Call JBCheb(X, 0.009001302, TJ, TJ1, Result)
        Call JBCheb(X, -0.001378767, TJ, TJ1, Result)
        Call JBCheb(X, -0.00110851, TJ, TJ1, Result)
        Call JBCheb(X, 0.0005915372, TJ, TJ1, Result)
        If Result > 0# Then
            Result = 0#
        End If
        JBTbl9 = Result
        Exit Function
    End If
    If S <= 7# Then
        X = 2# * (S - 2#) / 5# - 1#
        TJ = 1#
        TJ1 = X
        Call JBCheb(X, -6.387463, TJ, TJ1, Result)
        Call JBCheb(X, -2.845231, TJ, TJ1, Result)
        Call JBCheb(X, -0.1809956, TJ, TJ1, Result)
        Call JBCheb(X, -0.07543461, TJ, TJ1, Result)
        Call JBCheb(X, -0.004880397, TJ, TJ1, Result)
        Call JBCheb(X, -0.01160074, TJ, TJ1, Result)
        Call JBCheb(X, -0.007356527, TJ, TJ1, Result)
        Call JBCheb(X, -0.004394428, TJ, TJ1, Result)
        Call JBCheb(X, 0.0009619892, TJ, TJ1, Result)
        Call JBCheb(X, -0.0002758763, TJ, TJ1, Result)
        Call JBCheb(X, 0.00004790977, TJ, TJ1, Result)
        If Result > 0# Then
            Result = 0#
        End If
        JBTbl9 = Result
        Exit Function
    End If
    Result = -(2.020952 * (S - 7#)) - 9.516623
    JBTbl9 = Result
End Function
Private Function JBTbl10(ByVal S As Double) As Double
    Dim Result As Double
    Dim X As Double
    Dim TJ As Double
    Dim TJ1 As Double
    Result = 0#
    If S <= 1.2 Then
        X = 2# * (S - 0#) / 1.2 - 1#
        TJ = 1#
        TJ1 = X
        Call JBCheb(X, -0.4590993, TJ, TJ1, Result)
        Call JBCheb(X, -0.656273, TJ, TJ1, Result)
        Call JBCheb(X, -0.2353934, TJ, TJ1, Result)
        Call JBCheb(X, -0.04069933, TJ, TJ1, Result)
        Call JBCheb(X, -0.001849151, TJ, TJ1, Result)
        Call JBCheb(X, 0.0008931406, TJ, TJ1, Result)
        Call JBCheb(X, 0.0003636295, TJ, TJ1, Result)
        Call JBCheb(X, 0.0000117834, TJ, TJ1, Result)
        Call JBCheb(X, -0.00008917749, TJ, TJ1, Result)
        If Result > 0# Then
            Result = 0#
        End If
        JBTbl10 = Result
        Exit Function
    End If
    If S <= 2# Then
        X = 2# * (S - 1.2) / 0.8 - 1#
        TJ = 1#
        TJ1 = X
        Call JBCheb(X, -2.537658, TJ, TJ1, Result)
        Call JBCheb(X, -0.9962401, TJ, TJ1, Result)
        Call JBCheb(X, 0.1838715, TJ, TJ1, Result)
        Call JBCheb(X, 0.01055792, TJ, TJ1, Result)
        Call JBCheb(X, -0.02580316, TJ, TJ1, Result)
        Call JBCheb(X, 0.001781701, TJ, TJ1, Result)
        Call JBCheb(X, 0.003770362, TJ, TJ1, Result)
        Call JBCheb(X, -0.0004838983, TJ, TJ1, Result)
        Call JBCheb(X, -0.0006999052, TJ, TJ1, Result)
        If Result > 0# Then
            Result = 0#
        End If
        JBTbl10 = Result
        Exit Function
    End If
    If S <= 7# Then
        X = 2# * (S - 2#) / 5# - 1#
        TJ = 1#
        TJ1 = X
        Call JBCheb(X, -5.337524, TJ, TJ1, Result)
        Call JBCheb(X, -1.877029, TJ, TJ1, Result)
        Call JBCheb(X, 0.0473465, TJ, TJ1, Result)
        Call JBCheb(X, -0.04249254, TJ, TJ1, Result)
        Call JBCheb(X, 0.00332025, TJ, TJ1, Result)
        Call JBCheb(X, -0.006432266, TJ, TJ1, Result)
        If Result > 0# Then
            Result = 0#
        End If
        JBTbl10 = Result
        Exit Function
    End If
    Result = -(0.8711035 * (S - 7#)) - 7.212811
    JBTbl10 = Result
End Function
Private Function JBTbl11(ByVal S As Double) As Double
    Dim Result As Double
    Dim X As Double
    Dim TJ As Double
    Dim TJ1 As Double
    Result = 0#
    If S <= 1.2 Then
        X = 2# * (S - 0#) / 1.2 - 1#
        TJ = 1#
        TJ1 = X
        Call JBCheb(X, -0.4339517, TJ, TJ1, Result)
        Call JBCheb(X, -0.6051558, TJ, TJ1, Result)
        Call JBCheb(X, -0.2000992, TJ, TJ1, Result)
        Call JBCheb(X, -0.03022547, TJ, TJ1, Result)
        Call JBCheb(X, -0.0009808401, TJ, TJ1, Result)
        Call JBCheb(X, 0.000559287, TJ, TJ1, Result)
        Call JBCheb(X, 0.0003575081, TJ, TJ1, Result)
        Call JBCheb(X, 0.0002086173, TJ, TJ1, Result)
        Call JBCheb(X, 0.00006089011, TJ, TJ1, Result)
        If Result > 0# Then
            Result = 0#
        End If
        JBTbl11 = Result
        Exit Function
    End If
    If S <= 2.25 Then
        X = 2# * (S - 1.2) / 1.05 - 1#
        TJ = 1#
        TJ1 = X
        Call JBCheb(X, -2.523221, TJ, TJ1, Result)
        Call JBCheb(X, -1.068388, TJ, TJ1, Result)
        Call JBCheb(X, 0.2179661, TJ, TJ1, Result)
        Call JBCheb(X, -0.001555524, TJ, TJ1, Result)
        Call JBCheb(X, -0.03238964, TJ, TJ1, Result)
        Call JBCheb(X, 0.00736432, TJ, TJ1, Result)
        Call JBCheb(X, 0.004895771, TJ, TJ1, Result)
        Call JBCheb(X, -0.001762774, TJ, TJ1, Result)
        Call JBCheb(X, -0.000820134, TJ, TJ1, Result)
        If Result > 0# Then
            Result = 0#
        End If
        JBTbl11 = Result
        Exit Function
    End If
    If S <= 8# Then
        X = 2# * (S - 2.25) / 5.75 - 1#
        TJ = 1#
        TJ1 = X
        Call JBCheb(X, -5.212179, TJ, TJ1, Result)
        Call JBCheb(X, -1.684579, TJ, TJ1, Result)
        Call JBCheb(X, 0.08299519, TJ, TJ1, Result)
        Call JBCheb(X, -0.03606261, TJ, TJ1, Result)
        Call JBCheb(X, 0.007310869, TJ, TJ1, Result)
        Call JBCheb(X, -0.003320115, TJ, TJ1, Result)
        If Result > 0# Then
            Result = 0#
        End If
        JBTbl11 = Result
        Exit Function
    End If
    Result = -(0.5715445 * (S - 8#)) - 6.845834
    JBTbl11 = Result
End Function
Private Function JBTbl12(ByVal S As Double) As Double
    Dim Result As Double
    Dim X As Double
    Dim TJ As Double
    Dim TJ1 As Double
    Result = 0#
    If S <= 1# Then
        X = 2# * (S - 0#) / 1# - 1#
        TJ = 1#
        TJ1 = X
        Call JBCheb(X, -0.2736742, TJ, TJ1, Result)
        Call JBCheb(X, -0.3657836, TJ, TJ1, Result)
        Call JBCheb(X, -0.1047209, TJ, TJ1, Result)
        Call JBCheb(X, -0.01319599, TJ, TJ1, Result)
        Call JBCheb(X, -0.0005545631, TJ, TJ1, Result)
        Call JBCheb(X, 0.00009280445, TJ, TJ1, Result)
        Call JBCheb(X, 0.00002815679, TJ, TJ1, Result)
        Call JBCheb(X, -0.00002213519, TJ, TJ1, Result)
        Call JBCheb(X, 0.00001256838, TJ, TJ1, Result)
        If Result > 0# Then
            Result = 0#
        End If
        JBTbl12 = Result
        Exit Function
    End If
    If S <= 3# Then
        X = 2# * (S - 1#) / 2# - 1#
        TJ = 1#
        TJ1 = X
        Call JBCheb(X, -2.573947, TJ, TJ1, Result)
        Call JBCheb(X, -1.515287, TJ, TJ1, Result)
        Call JBCheb(X, 0.361188, TJ, TJ1, Result)
        Call JBCheb(X, -0.03271311, TJ, TJ1, Result)
        Call JBCheb(X, -0.06495815, TJ, TJ1, Result)
        Call JBCheb(X, 0.04141186, TJ, TJ1, Result)
        Call JBCheb(X, 0.0007180886, TJ, TJ1, Result)
        Call JBCheb(X, -0.01388211, TJ, TJ1, Result)
        Call JBCheb(X, 0.004890761, TJ, TJ1, Result)
        Call JBCheb(X, 0.003233175, TJ, TJ1, Result)
        Call JBCheb(X, -0.002946156, TJ, TJ1, Result)
        If Result > 0# Then
            Result = 0#
        End If
        JBTbl12 = Result
        Exit Function
    End If
    If S <= 12# Then
        X = 2# * (S - 3#) / 9# - 1#
        TJ = 1#
        TJ1 = X
        Call JBCheb(X, -5.947819, TJ, TJ1, Result)
        Call JBCheb(X, -2.034157, TJ, TJ1, Result)
        Call JBCheb(X, 0.06878986, TJ, TJ1, Result)
        Call JBCheb(X, -0.04078603, TJ, TJ1, Result)
        Call JBCheb(X, 0.006990977, TJ, TJ1, Result)
        Call JBCheb(X, -0.002866215, TJ, TJ1, Result)
        Call JBCheb(X, 0.003897866, TJ, TJ1, Result)
        Call JBCheb(X, 0.002512252, TJ, TJ1, Result)
        Call JBCheb(X, 0.002073743, TJ, TJ1, Result)
        Call JBCheb(X, 0.003022621, TJ, TJ1, Result)
        Call JBCheb(X, 0.001501343, TJ, TJ1, Result)
        If Result > 0# Then
            Result = 0#
        End If
        JBTbl12 = Result
        Exit Function
    End If
    Result = -(0.2877243 * (S - 12#)) - 7.936839
    JBTbl12 = Result
End Function
Private Function JBTbl13(ByVal S As Double) As Double
    Dim Result As Double
    Dim X As Double
    Dim TJ As Double
    Dim TJ1 As Double
    Result = 0#
    If S <= 1# Then
        X = 2# * (S - 0#) / 1# - 1#
        TJ = 1#
        TJ1 = X
        Call JBCheb(X, -0.2713276, TJ, TJ1, Result)
        Call JBCheb(X, -0.3557541, TJ, TJ1, Result)
        Call JBCheb(X, -0.09459092, TJ, TJ1, Result)
        Call JBCheb(X, -0.01044145, TJ, TJ1, Result)
        Call JBCheb(X, -0.0002546132, TJ, TJ1, Result)
        Call JBCheb(X, 0.0001002374, TJ, TJ1, Result)
        Call JBCheb(X, 0.00002349456, TJ, TJ1, Result)
        Call JBCheb(X, -0.00007025669, TJ, TJ1, Result)
        Call JBCheb(X, -0.00001590242, TJ, TJ1, Result)
        If Result > 0# Then
            Result = 0#
        End If
        JBTbl13 = Result
        Exit Function
    End If
    If S <= 3# Then
        X = 2# * (S - 1#) / 2# - 1#
        TJ = 1#
        TJ1 = X
        Call JBCheb(X, -2.454383, TJ, TJ1, Result)
        Call JBCheb(X, -1.467539, TJ, TJ1, Result)
        Call JBCheb(X, 0.3270774, TJ, TJ1, Result)
        Call JBCheb(X, -0.008075763, TJ, TJ1, Result)
        Call JBCheb(X, -0.06611647, TJ, TJ1, Result)
        Call JBCheb(X, 0.02990785, TJ, TJ1, Result)
        Call JBCheb(X, 0.008109212, TJ, TJ1, Result)
        Call JBCheb(X, -0.01135031, TJ, TJ1, Result)
        Call JBCheb(X, 0.0005915919, TJ, TJ1, Result)
        Call JBCheb(X, 0.00352239, TJ, TJ1, Result)
        Call JBCheb(X, -0.001144701, TJ, TJ1, Result)
        If Result > 0# Then
            Result = 0#
        End If
        JBTbl13 = Result
        Exit Function
    End If
    If S <= 13# Then
        X = 2# * (S - 3#) / 10# - 1#
        TJ = 1#
        TJ1 = X
        Call JBCheb(X, -5.736127, TJ, TJ1, Result)
        Call JBCheb(X, -1.920809, TJ, TJ1, Result)
        Call JBCheb(X, 0.1175858, TJ, TJ1, Result)
        Call JBCheb(X, -0.04002049, TJ, TJ1, Result)
        Call JBCheb(X, 0.01158966, TJ, TJ1, Result)
        Call JBCheb(X, -0.003157781, TJ, TJ1, Result)
        Call JBCheb(X, 0.002762172, TJ, TJ1, Result)
        Call JBCheb(X, 0.0005780347, TJ, TJ1, Result)
        Call JBCheb(X, -0.00119331, TJ, TJ1, Result)
        Call JBCheb(X, -0.00002442421, TJ, TJ1, Result)
        Call JBCheb(X, 0.002547756, TJ, TJ1, Result)
        If Result > 0# Then
            Result = 0#
        End If
        JBTbl13 = Result
        Exit Function
    End If
    Result = -(0.2799944 * (S - 13#)) - 7.566269
    JBTbl13 = Result
End Function
Private Function JBTbl14(ByVal S As Double) As Double
    Dim Result As Double
    Dim X As Double
    Dim TJ As Double
    Dim TJ1 As Double
    Result = 0#
    If S <= 1# Then
        X = 2# * (S - 0#) / 1# - 1#
        TJ = 1#
        TJ1 = X
        Call JBCheb(X, -0.2698527, TJ, TJ1, Result)
        Call JBCheb(X, -0.3479081, TJ, TJ1, Result)
        Call JBCheb(X, -0.08640733, TJ, TJ1, Result)
        Call JBCheb(X, -0.008466899, TJ, TJ1, Result)
        Call JBCheb(X, -0.0001469485, TJ, TJ1, Result)
        Call JBCheb(X, 0.00002150009, TJ, TJ1, Result)
        Call JBCheb(X, 0.00001965975, TJ, TJ1, Result)
        Call JBCheb(X, -0.0000471021, TJ, TJ1, Result)
        Call JBCheb(X, -0.00001327808, TJ, TJ1, Result)
        If Result > 0# Then
            Result = 0#
        End If
        JBTbl14 = Result
        Exit Function
    End If
    If S <= 3# Then
        X = 2# * (S - 1#) / 2# - 1#
        TJ = 1#
        TJ1 = X
        Call JBCheb(X, -2.350359, TJ, TJ1, Result)
        Call JBCheb(X, -1.421365, TJ, TJ1, Result)
        Call JBCheb(X, 0.2960468, TJ, TJ1, Result)
        Call JBCheb(X, 0.01149167, TJ, TJ1, Result)
        Call JBCheb(X, -0.06361109, TJ, TJ1, Result)
        Call JBCheb(X, 0.01976022, TJ, TJ1, Result)
        Call JBCheb(X, 0.010827, TJ, TJ1, Result)
        Call JBCheb(X, -0.008563328, TJ, TJ1, Result)
        Call JBCheb(X, -0.001453123, TJ, TJ1, Result)
        Call JBCheb(X, 0.002917559, TJ, TJ1, Result)
        Call JBCheb(X, -0.00001151067, TJ, TJ1, Result)
        If Result > 0# Then
            Result = 0#
        End If
        JBTbl14 = Result
        Exit Function
    End If
    If S <= 15# Then
        X = 2# * (S - 3#) / 12# - 1#
        TJ = 1#
        TJ1 = X
        Call JBCheb(X, -5.746892, TJ, TJ1, Result)
        Call JBCheb(X, -2.010441, TJ, TJ1, Result)
        Call JBCheb(X, 0.1566146, TJ, TJ1, Result)
        Call JBCheb(X, -0.0512969, TJ, TJ1, Result)
        Call JBCheb(X, 0.01929724, TJ, TJ1, Result)
        Call JBCheb(X, -0.002524227, TJ, TJ1, Result)
        Call JBCheb(X, 0.003192933, TJ, TJ1, Result)
        Call JBCheb(X, -0.000425473, TJ, TJ1, Result)
        Call JBCheb(X, 0.001620685, TJ, TJ1, Result)
        Call JBCheb(X, 0.0007289618, TJ, TJ1, Result)
        Call JBCheb(X, -0.00211235, TJ, TJ1, Result)
        If Result > 0# Then
            Result = 0#
        End If
        JBTbl14 = Result
        Exit Function
    End If
    Result = -(0.2590621 * (S - 15#)) - 7.632238
    JBTbl14 = Result
End Function
Private Function JBTbl15(ByVal S As Double) As Double
    Dim Result As Double
    Dim X As Double
    Dim TJ As Double
    Dim TJ1 As Double
    Result = 0#
    If S <= 2# Then
        X = 2# * (S - 0#) / 2# - 1#
        TJ = 1#
        TJ1 = X
        Call JBCheb(X, -1.04366, TJ, TJ1, Result)
        Call JBCheb(X, -1.361653, TJ, TJ1, Result)
        Call JBCheb(X, -0.3009497, TJ, TJ1, Result)
        Call JBCheb(X, 0.04951784, TJ, TJ1, Result)
        Call JBCheb(X, 0.04377903, TJ, TJ1, Result)
        Call JBCheb(X, 0.01003253, TJ, TJ1, Result)
        Call JBCheb(X, -0.001271309, TJ, TJ1, Result)
        If Result > 0# Then
            Result = 0#
        End If
        JBTbl15 = Result
        Exit Function
    End If
    If S <= 5# Then
        X = 2# * (S - 2#) / 3# - 1#
        TJ = 1#
        TJ1 = X
        Call JBCheb(X, -3.582778, TJ, TJ1, Result)
        Call JBCheb(X, -0.8349578, TJ, TJ1, Result)
        Call JBCheb(X, 0.09476514, TJ, TJ1, Result)
        Call JBCheb(X, -0.02717385, TJ, TJ1, Result)
        Call JBCheb(X, 0.01222591, TJ, TJ1, Result)
        Call JBCheb(X, -0.006635124, TJ, TJ1, Result)
        Call JBCheb(X, 0.002815993, TJ, TJ1, Result)
        If Result > 0# Then
            Result = 0#
        End If
        JBTbl15 = Result
        Exit Function
    End If
    If S <= 17# Then
        X = 2# * (S - 5#) / 12# - 1#
        TJ = 1#
        TJ1 = X
        Call JBCheb(X, -6.115476, TJ, TJ1, Result)
        Call JBCheb(X, -1.655936, TJ, TJ1, Result)
        Call JBCheb(X, 0.0840431, TJ, TJ1, Result)
        Call JBCheb(X, -0.02663794, TJ, TJ1, Result)
        Call JBCheb(X, 0.008868618, TJ, TJ1, Result)
        Call JBCheb(X, 0.001381447, TJ, TJ1, Result)
        Call JBCheb(X, 0.0009444801, TJ, TJ1, Result)
        Call JBCheb(X, -0.0001581503, TJ, TJ1, Result)
        Call JBCheb(X, -0.0009468696, TJ, TJ1, Result)
        Call JBCheb(X, 0.001728509, TJ, TJ1, Result)
        Call JBCheb(X, 0.00120647, TJ, TJ1, Result)
        If Result > 0# Then
            Result = 0#
        End If
        JBTbl15 = Result
        Exit Function
    End If
    Result = -(0.1927937 * (S - 17#)) - 7.700983
    JBTbl15 = Result
End Function
Private Function JBTbl16(ByVal S As Double) As Double
    Dim Result As Double
    Dim X As Double
    Dim TJ As Double
    Dim TJ1 As Double
    Result = 0#
    If S <= 2# Then
        X = 2# * (S - 0#) / 2# - 1#
        TJ = 1#
        TJ1 = X
        Call JBCheb(X, -1.00257, TJ, TJ1, Result)
        Call JBCheb(X, -1.298141, TJ, TJ1, Result)
        Call JBCheb(X, -0.2832803, TJ, TJ1, Result)
        Call JBCheb(X, 0.03877026, TJ, TJ1, Result)
        Call JBCheb(X, 0.03539436, TJ, TJ1, Result)
        Call JBCheb(X, 0.008439658, TJ, TJ1, Result)
        Call JBCheb(X, -0.0004756911, TJ, TJ1, Result)
        If Result > 0# Then
            Result = 0#
        End If
        JBTbl16 = Result
        Exit Function
    End If
    If S <= 5# Then
        X = 2# * (S - 2#) / 3# - 1#
        TJ = 1#
        TJ1 = X
        Call JBCheb(X, -3.486198, TJ, TJ1, Result)
        Call JBCheb(X, -0.8242944, TJ, TJ1, Result)
        Call JBCheb(X, 0.1020002, TJ, TJ1, Result)
        Call JBCheb(X, -0.03130531, TJ, TJ1, Result)
        Call JBCheb(X, 0.01512373, TJ, TJ1, Result)
        Call JBCheb(X, -0.008054876, TJ, TJ1, Result)
        Call JBCheb(X, 0.003556839, TJ, TJ1, Result)
        If Result > 0# Then
            Result = 0#
        End If
        JBTbl16 = Result
        Exit Function
    End If
    If S <= 20# Then
        X = 2# * (S - 5#) / 15# - 1#
        TJ = 1#
        TJ1 = X
        Call JBCheb(X, -6.241608, TJ, TJ1, Result)
        Call JBCheb(X, -1.832655, TJ, TJ1, Result)
        Call JBCheb(X, 0.1340545, TJ, TJ1, Result)
        Call JBCheb(X, -0.03361143, TJ, TJ1, Result)
        Call JBCheb(X, 0.01283219, TJ, TJ1, Result)
        Call JBCheb(X, 0.003484549, TJ, TJ1, Result)
        Call JBCheb(X, 0.001805968, TJ, TJ1, Result)
        Call JBCheb(X, -0.002057243, TJ, TJ1, Result)
        Call JBCheb(X, -0.001454439, TJ, TJ1, Result)
        Call JBCheb(X, -0.002177513, TJ, TJ1, Result)
        Call JBCheb(X, -0.001819209, TJ, TJ1, Result)
        If Result > 0# Then
            Result = 0#
        End If
        JBTbl16 = Result
        Exit Function
    End If
    Result = -(0.239158 * (S - 20#)) - 7.963205
    JBTbl16 = Result
End Function
Private Function JBTbl17(ByVal S As Double) As Double
    Dim Result As Double
    Dim X As Double
    Dim TJ As Double
    Dim TJ1 As Double
    Result = 0#
    If S <= 3# Then
        X = 2# * (S - 0#) / 3# - 1#
        TJ = 1#
        TJ1 = X
        Call JBCheb(X, -1.566973, TJ, TJ1, Result)
        Call JBCheb(X, -1.81033, TJ, TJ1, Result)
        Call JBCheb(X, -0.04840039, TJ, TJ1, Result)
        Call JBCheb(X, 0.2337294, TJ, TJ1, Result)
        Call JBCheb(X, -0.0005383549, TJ, TJ1, Result)
        Call JBCheb(X, -0.05556515, TJ, TJ1, Result)
        Call JBCheb(X, -0.008656965, TJ, TJ1, Result)
        Call JBCheb(X, 0.01404569, TJ, TJ1, Result)
        Call JBCheb(X, 0.006447867, TJ, TJ1, Result)
        If Result > 0# Then
            Result = 0#
        End If
        JBTbl17 = Result
        Exit Function
    End If
    If S <= 6# Then
        X = 2# * (S - 3#) / 3# - 1#
        TJ = 1#
        TJ1 = X
        Call JBCheb(X, -3.905684, TJ, TJ1, Result)
        Call JBCheb(X, -0.622292, TJ, TJ1, Result)
        Call JBCheb(X, 0.04146667, TJ, TJ1, Result)
        Call JBCheb(X, -0.004809176, TJ, TJ1, Result)
        Call JBCheb(X, 0.001057028, TJ, TJ1, Result)
        Call JBCheb(X, -0.0001211838, TJ, TJ1, Result)
        Call JBCheb(X, -0.0004099683, TJ, TJ1, Result)
        Call JBCheb(X, 0.0001161105, TJ, TJ1, Result)
        Call JBCheb(X, 0.0002225465, TJ, TJ1, Result)
        If Result > 0# Then
            Result = 0#
        End If
        JBTbl17 = Result
        Exit Function
    End If
    If S <= 24# Then
        X = 2# * (S - 6#) / 18# - 1#
        TJ = 1#
        TJ1 = X
        Call JBCheb(X, -6.594282, TJ, TJ1, Result)
        Call JBCheb(X, -1.917838, TJ, TJ1, Result)
        Call JBCheb(X, 0.145598, TJ, TJ1, Result)
        Call JBCheb(X, -0.02999589, TJ, TJ1, Result)
        Call JBCheb(X, 0.005604263, TJ, TJ1, Result)
        Call JBCheb(X, -0.003484445, TJ, TJ1, Result)
        Call JBCheb(X, -0.001819937, TJ, TJ1, Result)
        Call JBCheb(X, -0.00293039, TJ, TJ1, Result)
        Call JBCheb(X, 0.0002771761, TJ, TJ1, Result)
        Call JBCheb(X, -0.0006232581, TJ, TJ1, Result)
        Call JBCheb(X, -0.0007029083, TJ, TJ1, Result)
        If Result > 0# Then
            Result = 0#
        End If
        JBTbl17 = Result
        Exit Function
    End If
    Result = -(0.2127771 * (S - 24#)) - 8.400197
    JBTbl17 = Result
End Function
Private Function JBTbl18(ByVal S As Double) As Double
    Dim Result As Double
    Dim X As Double
    Dim TJ As Double
    Dim TJ1 As Double
    Result = 0#
    If S <= 3# Then
        X = 2# * (S - 0#) / 3# - 1#
        TJ = 1#
        TJ1 = X
        Call JBCheb(X, -1.526802, TJ, TJ1, Result)
        Call JBCheb(X, -1.762373, TJ, TJ1, Result)
        Call JBCheb(X, -0.0559889, TJ, TJ1, Result)
        Call JBCheb(X, 0.2189437, TJ, TJ1, Result)
        Call JBCheb(X, 0.005971721, TJ, TJ1, Result)
        Call JBCheb(X, -0.04823067, TJ, TJ1, Result)
        Call JBCheb(X, -0.01064501, TJ, TJ1, Result)
        Call JBCheb(X, 0.01014932, TJ, TJ1, Result)
        Call JBCheb(X, 0.005953513, TJ, TJ1, Result)
        If Result > 0# Then
            Result = 0#
        End If
        JBTbl18 = Result
        Exit Function
    End If
    If S <= 6# Then
        X = 2# * (S - 3#) / 3# - 1#
        TJ = 1#
        TJ1 = X
        Call JBCheb(X, -3.818669, TJ, TJ1, Result)
        Call JBCheb(X, -0.6070918, TJ, TJ1, Result)
        Call JBCheb(X, 0.04277196, TJ, TJ1, Result)
        Call JBCheb(X, -0.004879817, TJ, TJ1, Result)
        Call JBCheb(X, 0.0006887357, TJ, TJ1, Result)
        Call JBCheb(X, 0.00001638451, TJ, TJ1, Result)
        Call JBCheb(X, 0.00015028, TJ, TJ1, Result)
        Call JBCheb(X, -0.00003165796, TJ, TJ1, Result)
        Call JBCheb(X, 0.0000503496, TJ, TJ1, Result)
        If Result > 0# Then
            Result = 0#
        End If
        JBTbl18 = Result
        Exit Function
    End If
    If S <= 20# Then
        X = 2# * (S - 6#) / 14# - 1#
        TJ = 1#
        TJ1 = X
        Call JBCheb(X, -6.010656, TJ, TJ1, Result)
        Call JBCheb(X, -1.496296, TJ, TJ1, Result)
        Call JBCheb(X, 0.1002227, TJ, TJ1, Result)
        Call JBCheb(X, -0.0233825, TJ, TJ1, Result)
        Call JBCheb(X, 0.004137036, TJ, TJ1, Result)
        Call JBCheb(X, -0.002586202, TJ, TJ1, Result)
        Call JBCheb(X, -0.0009736384, TJ, TJ1, Result)
        Call JBCheb(X, 0.001332251, TJ, TJ1, Result)
        Call JBCheb(X, 0.001877982, TJ, TJ1, Result)
        Call JBCheb(X, -0.00001160963, TJ, TJ1, Result)
        Call JBCheb(X, -0.002547247, TJ, TJ1, Result)
        If Result > 0# Then
            Result = 0#
        End If
        JBTbl18 = Result
        Exit Function
    End If
    Result = -(0.1684623 * (S - 20#)) - 7.428883
    JBTbl18 = Result
End Function
Private Function JBTbl19(ByVal S As Double) As Double
    Dim Result As Double
    Dim X As Double
    Dim TJ As Double
    Dim TJ1 As Double
    Result = 0#
    If S <= 3# Then
        X = 2# * (S - 0#) / 3# - 1#
        TJ = 1#
        TJ1 = X
        Call JBCheb(X, -1.490213, TJ, TJ1, Result)
        Call JBCheb(X, -1.719633, TJ, TJ1, Result)
        Call JBCheb(X, -0.06459123, TJ, TJ1, Result)
        Call JBCheb(X, 0.2034878, TJ, TJ1, Result)
        Call JBCheb(X, 0.01113868, TJ, TJ1, Result)
        Call JBCheb(X, -0.04030922, TJ, TJ1, Result)
        Call JBCheb(X, -0.01054022, TJ, TJ1, Result)
        Call JBCheb(X, 0.007525623, TJ, TJ1, Result)
        Call JBCheb(X, 0.00527736, TJ, TJ1, Result)
        If Result > 0# Then
            Result = 0#
        End If
        JBTbl19 = Result
        Exit Function
    End If
    If S <= 6# Then
        X = 2# * (S - 3#) / 3# - 1#
        TJ = 1#
        TJ1 = X
        Call JBCheb(X, -3.74475, TJ, TJ1, Result)
        Call JBCheb(X, -0.5977749, TJ, TJ1, Result)
        Call JBCheb(X, 0.04223716, TJ, TJ1, Result)
        Call JBCheb(X, -0.005363889, TJ, TJ1, Result)
        Call JBCheb(X, 0.0005711774, TJ, TJ1, Result)
        Call JBCheb(X, -0.0005557257, TJ, TJ1, Result)
        Call JBCheb(X, 0.0004254794, TJ, TJ1, Result)
        Call JBCheb(X, 0.00009034207, TJ, TJ1, Result)
        Call JBCheb(X, 0.00005498107, TJ, TJ1, Result)
        If Result > 0# Then
            Result = 0#
        End If
        JBTbl19 = Result
        Exit Function
    End If
    If S <= 20# Then
        X = 2# * (S - 6#) / 14# - 1#
        TJ = 1#
        TJ1 = X
        Call JBCheb(X, -5.872768, TJ, TJ1, Result)
        Call JBCheb(X, -1.430689, TJ, TJ1, Result)
        Call JBCheb(X, 0.1136575, TJ, TJ1, Result)
        Call JBCheb(X, -0.01726627, TJ, TJ1, Result)
        Call JBCheb(X, 0.00342111, TJ, TJ1, Result)
        Call JBCheb(X, -0.00158151, TJ, TJ1, Result)
        Call JBCheb(X, -0.000555952, TJ, TJ1, Result)
        Call JBCheb(X, -0.0006838208, TJ, TJ1, Result)
        Call JBCheb(X, 0.0008428839, TJ, TJ1, Result)
        Call JBCheb(X, -0.0007170682, TJ, TJ1, Result)
        Call JBCheb(X, -0.0006006647, TJ, TJ1, Result)
        If Result > 0# Then
            Result = 0#
        End If
        JBTbl19 = Result
        Exit Function
    End If
    Result = -(0.1539373 * (S - 20#)) - 7.206941
    JBTbl19 = Result
End Function
Private Function JBTbl20(ByVal S As Double) As Double
    Dim Result As Double
    Dim X As Double
    Dim TJ As Double
    Dim TJ1 As Double
    Result = 0#
    If S <= 4# Then
        X = 2# * (S - 0#) / 4# - 1#
        TJ = 1#
        TJ1 = X
        Call JBCheb(X, -1.854794, TJ, TJ1, Result)
        Call JBCheb(X, -1.948947, TJ, TJ1, Result)
        Call JBCheb(X, 0.1632184, TJ, TJ1, Result)
        Call JBCheb(X, 0.2139397, TJ, TJ1, Result)
        Call JBCheb(X, -0.1006237, TJ, TJ1, Result)
        Call JBCheb(X, -0.03810031, TJ, TJ1, Result)
        Call JBCheb(X, 0.0357362, TJ, TJ1, Result)
        Call JBCheb(X, 0.009951242, TJ, TJ1, Result)
        Call JBCheb(X, -0.01274092, TJ, TJ1, Result)
        Call JBCheb(X, -0.003464196, TJ, TJ1, Result)
        Call JBCheb(X, 0.004882139, TJ, TJ1, Result)
        Call JBCheb(X, 0.001575144, TJ, TJ1, Result)
        Call JBCheb(X, -0.001822804, TJ, TJ1, Result)
        Call JBCheb(X, -0.0007061348, TJ, TJ1, Result)
        Call JBCheb(X, 0.0005908404, TJ, TJ1, Result)
        Call JBCheb(X, 0.0001978353, TJ, TJ1, Result)
        If Result > 0# Then
            Result = 0#
        End If
        JBTbl20 = Result
        Exit Function
    End If
    If S <= 15# Then
        X = 2# * (S - 4#) / 11# - 1#
        TJ = 1#
        TJ1 = X
        Call JBCheb(X, -5.030989, TJ, TJ1, Result)
        Call JBCheb(X, -1.327151, TJ, TJ1, Result)
        Call JBCheb(X, 0.1346404, TJ, TJ1, Result)
        Call JBCheb(X, -0.02840051, TJ, TJ1, Result)
        Call JBCheb(X, 0.007578551, TJ, TJ1, Result)
        Call JBCheb(X, -0.0009813886, TJ, TJ1, Result)
        Call JBCheb(X, 0.00005905973, TJ, TJ1, Result)
        Call JBCheb(X, -0.0005358489, TJ, TJ1, Result)
        Call JBCheb(X, -0.0003450795, TJ, TJ1, Result)
        Call JBCheb(X, -0.0006941157, TJ, TJ1, Result)
        Call JBCheb(X, -0.0007432418, TJ, TJ1, Result)
        Call JBCheb(X, -0.0002070537, TJ, TJ1, Result)
        Call JBCheb(X, 0.0009375654, TJ, TJ1, Result)
        Call JBCheb(X, 0.0005367378, TJ, TJ1, Result)
        Call JBCheb(X, 0.0009890859, TJ, TJ1, Result)
        Call JBCheb(X, 0.0006679782, TJ, TJ1, Result)
        If Result > 0# Then
            Result = 0#
        End If
        JBTbl20 = Result
        Exit Function
    End If
    If S <= 25# Then
        X = 2# * (S - 15#) / 10# - 1#
        TJ = 1#
        TJ1 = X
        Call JBCheb(X, -7.015854, TJ, TJ1, Result)
        Call JBCheb(X, -0.7487737, TJ, TJ1, Result)
        Call JBCheb(X, 0.02244254, TJ, TJ1, Result)
        If Result > 0# Then
            Result = 0#
        End If
        JBTbl20 = Result
        Exit Function
    End If
    Result = -(0.1318007 * (S - 25#)) - 7.742185
    JBTbl20 = Result
End Function
Private Function JBTbl30(ByVal S As Double) As Double
    Dim Result As Double
    Dim X As Double
    Dim TJ As Double
    Dim TJ1 As Double
    Result = 0#
    If S <= 4# Then
        X = 2# * (S - 0#) / 4# - 1#
        TJ = 1#
        TJ1 = X
        Call JBCheb(X, -1.630822, TJ, TJ1, Result)
        Call JBCheb(X, -1.724298, TJ, TJ1, Result)
        Call JBCheb(X, 0.07872756, TJ, TJ1, Result)
        Call JBCheb(X, 0.1658268, TJ, TJ1, Result)
        Call JBCheb(X, -0.03573597, TJ, TJ1, Result)
        Call JBCheb(X, -0.02994157, TJ, TJ1, Result)
        Call JBCheb(X, 0.005994825, TJ, TJ1, Result)
        Call JBCheb(X, 0.007394303, TJ, TJ1, Result)
        Call JBCheb(X, -0.0005785029, TJ, TJ1, Result)
        Call JBCheb(X, -0.001990264, TJ, TJ1, Result)
        Call JBCheb(X, -0.0001037838, TJ, TJ1, Result)
        Call JBCheb(X, 0.0006755546, TJ, TJ1, Result)
        Call JBCheb(X, 0.0001774473, TJ, TJ1, Result)
        Call JBCheb(X, -0.0002821395, TJ, TJ1, Result)
        Call JBCheb(X, -0.0001392603, TJ, TJ1, Result)
        Call JBCheb(X, 0.0001353313, TJ, TJ1, Result)
        If Result > 0# Then
            Result = 0#
        End If
        JBTbl30 = Result
        Exit Function
    End If
    If S <= 15# Then
        X = 2# * (S - 4#) / 11# - 1#
        TJ = 1#
        TJ1 = X
        Call JBCheb(X, -4.539322, TJ, TJ1, Result)
        Call JBCheb(X, -1.197018, TJ, TJ1, Result)
        Call JBCheb(X, 0.1396848, TJ, TJ1, Result)
        Call JBCheb(X, -0.02804293, TJ, TJ1, Result)
        Call JBCheb(X, 0.006867928, TJ, TJ1, Result)
        Call JBCheb(X, -0.002768758, TJ, TJ1, Result)
        Call JBCheb(X, 0.0005211792, TJ, TJ1, Result)
        Call JBCheb(X, 0.0004925799, TJ, TJ1, Result)
        Call JBCheb(X, 0.0005046235, TJ, TJ1, Result)
        Call JBCheb(X, -0.00009536469, TJ, TJ1, Result)
        Call JBCheb(X, -0.0006489642, TJ, TJ1, Result)
        If Result > 0# Then
            Result = 0#
        End If
        JBTbl30 = Result
        Exit Function
    End If
    If S <= 25# Then
        X = 2# * (S - 15#) / 10# - 1#
        TJ = 1#
        TJ1 = X
        Call JBCheb(X, -6.263462, TJ, TJ1, Result)
        Call JBCheb(X, -0.6177316, TJ, TJ1, Result)
        Call JBCheb(X, 0.02590637, TJ, TJ1, Result)
        If Result > 0# Then
            Result = 0#
        End If
        JBTbl30 = Result
        Exit Function
    End If
    Result = -(0.1028212 * (S - 25#)) - 6.855288
    JBTbl30 = Result
End Function
Private Function JBTbl50(ByVal S As Double) As Double
    Dim Result As Double
    Dim X As Double
    Dim TJ As Double
    Dim TJ1 As Double
    Result = 0#
    If S <= 4# Then
        X = 2# * (S - 0#) / 4# - 1#
        TJ = 1#
        TJ1 = X
        Call JBCheb(X, -1.436279, TJ, TJ1, Result)
        Call JBCheb(X, -1.519711, TJ, TJ1, Result)
        Call JBCheb(X, 0.01148699, TJ, TJ1, Result)
        Call JBCheb(X, 0.1001204, TJ, TJ1, Result)
        Call JBCheb(X, -0.00320762, TJ, TJ1, Result)
        Call JBCheb(X, -0.01034778, TJ, TJ1, Result)
        Call JBCheb(X, -0.001220322, TJ, TJ1, Result)
        Call JBCheb(X, 0.00103326, TJ, TJ1, Result)
        Call JBCheb(X, 0.000258828, TJ, TJ1, Result)
        Call JBCheb(X, -0.0001851653, TJ, TJ1, Result)
        Call JBCheb(X, -0.0001287733, TJ, TJ1, Result)
        If Result > 0# Then
            Result = 0#
        End If
        JBTbl50 = Result
        Exit Function
    End If
    If S <= 15# Then
        X = 2# * (S - 4#) / 11# - 1#
        TJ = 1#
        TJ1 = X
        Call JBCheb(X, -4.234645, TJ, TJ1, Result)
        Call JBCheb(X, -1.189127, TJ, TJ1, Result)
        Call JBCheb(X, 0.1429738, TJ, TJ1, Result)
        Call JBCheb(X, -0.03058822, TJ, TJ1, Result)
        Call JBCheb(X, 0.009086776, TJ, TJ1, Result)
        Call JBCheb(X, -0.001445783, TJ, TJ1, Result)
        Call JBCheb(X, 0.001311671, TJ, TJ1, Result)
        Call JBCheb(X, -0.0007261298, TJ, TJ1, Result)
        Call JBCheb(X, 0.0006496987, TJ, TJ1, Result)
        Call JBCheb(X, 0.0002605249, TJ, TJ1, Result)
        Call JBCheb(X, 0.0008162282, TJ, TJ1, Result)
        If Result > 0# Then
            Result = 0#
        End If
        JBTbl50 = Result
        Exit Function
    End If
    If S <= 25# Then
        X = 2# * (S - 15#) / 10# - 1#
        TJ = 1#
        TJ1 = X
        Call JBCheb(X, -5.921095, TJ, TJ1, Result)
        Call JBCheb(X, -0.5888603, TJ, TJ1, Result)
        Call JBCheb(X, 0.03080113, TJ, TJ1, Result)
        If Result > 0# Then
            Result = 0#
        End If
        JBTbl50 = Result
        Exit Function
    End If
    Result = -(0.09313116 * (S - 25#)) - 6.479154
    JBTbl50 = Result
End Function
Private Function JBTbl65(ByVal S As Double) As Double
    Dim Result As Double
    Dim X As Double
    Dim TJ As Double
    Dim TJ1 As Double
    Result = 0#
    If S <= 4# Then
        X = 2# * (S - 0#) / 4# - 1#
        TJ = 1#
        TJ1 = X
        Call JBCheb(X, -1.360024, TJ, TJ1, Result)
        Call JBCheb(X, -1.434631, TJ, TJ1, Result)
        Call JBCheb(X, -0.00651458, TJ, TJ1, Result)
        Call JBCheb(X, 0.07332038, TJ, TJ1, Result)
        Call JBCheb(X, 0.001158197, TJ, TJ1, Result)
        Call JBCheb(X, -0.005121233, TJ, TJ1, Result)
        Call JBCheb(X, -0.001051056, TJ, TJ1, Result)
        If Result > 0# Then
            Result = 0#
        End If
        JBTbl65 = Result
        Exit Function
    End If
    If S <= 15# Then
        X = 2# * (S - 4#) / 11# - 1#
        TJ = 1#
        TJ1 = X
        Call JBCheb(X, -4.148601, TJ, TJ1, Result)
        Call JBCheb(X, -1.214233, TJ, TJ1, Result)
        Call JBCheb(X, 0.1487977, TJ, TJ1, Result)
        Call JBCheb(X, -0.0342472, TJ, TJ1, Result)
        Call JBCheb(X, 0.01116715, TJ, TJ1, Result)
        Call JBCheb(X, -0.004043152, TJ, TJ1, Result)
        Call JBCheb(X, 0.001718149, TJ, TJ1, Result)
        Call JBCheb(X, -0.001313701, TJ, TJ1, Result)
        Call JBCheb(X, 0.0003097305, TJ, TJ1, Result)
        Call JBCheb(X, 0.0002181031, TJ, TJ1, Result)
        Call JBCheb(X, 0.0001256975, TJ, TJ1, Result)
        If Result > 0# Then
            Result = 0#
        End If
        JBTbl65 = Result
        Exit Function
    End If
    If S <= 25# Then
        X = 2# * (S - 15#) / 10# - 1#
        TJ = 1#
        TJ1 = X
        Call JBCheb(X, -5.858951, TJ, TJ1, Result)
        Call JBCheb(X, -0.5895179, TJ, TJ1, Result)
        Call JBCheb(X, 0.02933237, TJ, TJ1, Result)
        If Result > 0# Then
            Result = 0#
        End If
        JBTbl65 = Result
        Exit Function
    End If
    Result = -(0.09443768 * (S - 25#)) - 6.419137
    JBTbl65 = Result
End Function
Private Function JBTbl100(ByVal S As Double) As Double
    Dim Result As Double
    Dim X As Double
    Dim TJ As Double
    Dim TJ1 As Double
    Result = 0#
    If S <= 4# Then
        X = 2# * (S - 0#) / 4# - 1#
        TJ = 1#
        TJ1 = X
        Call JBCheb(X, -1.257021, TJ, TJ1, Result)
        Call JBCheb(X, -1.313418, TJ, TJ1, Result)
        Call JBCheb(X, -0.01628931, TJ, TJ1, Result)
        Call JBCheb(X, 0.04264287, TJ, TJ1, Result)
        Call JBCheb(X, 0.001518487, TJ, TJ1, Result)
        Call JBCheb(X, -0.001499826, TJ, TJ1, Result)
        Call JBCheb(X, -0.0004836044, TJ, TJ1, Result)
        If Result > 0# Then
            Result = 0#
        End If
        JBTbl100 = Result
        Exit Function
    End If
    If S <= 15# Then
        X = 2# * (S - 4#) / 11# - 1#
        TJ = 1#
        TJ1 = X
        Call JBCheb(X, -4.056508, TJ, TJ1, Result)
        Call JBCheb(X, -1.27969, TJ, TJ1, Result)
        Call JBCheb(X, 0.1665746, TJ, TJ1, Result)
        Call JBCheb(X, -0.04290012, TJ, TJ1, Result)
        Call JBCheb(X, 0.01487632, TJ, TJ1, Result)
        Call JBCheb(X, -0.005704465, TJ, TJ1, Result)
        Call JBCheb(X, 0.002211669, TJ, TJ1, Result)
        If Result > 0# Then
            Result = 0#
        End If
        JBTbl100 = Result
        Exit Function
    End If
    If S <= 25# Then
        X = 2# * (S - 15#) / 10# - 1#
        TJ = 1#
        TJ1 = X
        Call JBCheb(X, -5.866099, TJ, TJ1, Result)
        Call JBCheb(X, -0.6399767, TJ, TJ1, Result)
        Call JBCheb(X, 0.02498208, TJ, TJ1, Result)
        If Result > 0# Then
            Result = 0#
        End If
        JBTbl100 = Result
        Exit Function
    End If
    Result = -(0.1080097 * (S - 25#)) - 6.481094
    JBTbl100 = Result
End Function
Private Function JBTbl130(ByVal S As Double) As Double
    Dim Result As Double
    Dim X As Double
    Dim TJ As Double
    Dim TJ1 As Double
    Result = 0#
    If S <= 4# Then
        X = 2# * (S - 0#) / 4# - 1#
        TJ = 1#
        TJ1 = X
        Call JBCheb(X, -1.207999, TJ, TJ1, Result)
        Call JBCheb(X, -1.253864, TJ, TJ1, Result)
        Call JBCheb(X, -0.01618032, TJ, TJ1, Result)
        Call JBCheb(X, 0.03112729, TJ, TJ1, Result)
        Call JBCheb(X, 0.001210546, TJ, TJ1, Result)
        Call JBCheb(X, -0.0004732602, TJ, TJ1, Result)
        Call JBCheb(X, -0.0002410527, TJ, TJ1, Result)
        If Result > 0# Then
            Result = 0#
        End If
        JBTbl130 = Result
        Exit Function
    End If
    If S <= 15# Then
        X = 2# * (S - 4#) / 11# - 1#
        TJ = 1#
        TJ1 = X
        Call JBCheb(X, -4.026324, TJ, TJ1, Result)
        Call JBCheb(X, -1.33199, TJ, TJ1, Result)
        Call JBCheb(X, 0.1779129, TJ, TJ1, Result)
        Call JBCheb(X, -0.04674749, TJ, TJ1, Result)
        Call JBCheb(X, 0.01669077, TJ, TJ1, Result)
        Call JBCheb(X, -0.005679136, TJ, TJ1, Result)
        Call JBCheb(X, 0.0008833221, TJ, TJ1, Result)
        If Result > 0# Then
            Result = 0#
        End If
        JBTbl130 = Result
        Exit Function
    End If
    If S <= 25# Then
        X = 2# * (S - 15#) / 10# - 1#
        TJ = 1#
        TJ1 = X
        Call JBCheb(X, -5.893951, TJ, TJ1, Result)
        Call JBCheb(X, -0.6475304, TJ, TJ1, Result)
        Call JBCheb(X, 0.03116734, TJ, TJ1, Result)
        If Result > 0# Then
            Result = 0#
        End If
        JBTbl130 = Result
        Exit Function
    End If
    Result = -(0.1045722 * (S - 25#)) - 6.510314
    JBTbl130 = Result
End Function
Private Function JBTbl200(ByVal S As Double) As Double
    Dim Result As Double
    Dim X As Double
    Dim TJ As Double
    Dim TJ1 As Double
    Result = 0#
    If S <= 4# Then
        X = 2# * (S - 0#) / 4# - 1#
        TJ = 1#
        TJ1 = X
        Call JBCheb(X, -1.146155, TJ, TJ1, Result)
        Call JBCheb(X, -1.177398, TJ, TJ1, Result)
        Call JBCheb(X, -0.0129797, TJ, TJ1, Result)
        Call JBCheb(X, 0.01869745, TJ, TJ1, Result)
        Call JBCheb(X, 0.0001717288, TJ, TJ1, Result)
        Call JBCheb(X, -0.0001982108, TJ, TJ1, Result)
        Call JBCheb(X, 0.00006427636, TJ, TJ1, Result)
        If Result > 0# Then
            Result = 0#
        End If
        JBTbl200 = Result
        Exit Function
    End If
    If S <= 15# Then
        X = 2# * (S - 4#) / 11# - 1#
        TJ = 1#
        TJ1 = X
        Call JBCheb(X, -4.034235, TJ, TJ1, Result)
        Call JBCheb(X, -1.455006, TJ, TJ1, Result)
        Call JBCheb(X, 0.1942996, TJ, TJ1, Result)
        Call JBCheb(X, -0.04973795, TJ, TJ1, Result)
        Call JBCheb(X, 0.01418812, TJ, TJ1, Result)
        Call JBCheb(X, -0.003156778, TJ, TJ1, Result)
        Call JBCheb(X, 0.00004896705, TJ, TJ1, Result)
        If Result > 0# Then
            Result = 0#
        End If
        JBTbl200 = Result
        Exit Function
    End If
    If S <= 25# Then
        X = 2# * (S - 15#) / 10# - 1#
        TJ = 1#
        TJ1 = X
        Call JBCheb(X, -6.086071, TJ, TJ1, Result)
        Call JBCheb(X, -0.7152176, TJ, TJ1, Result)
        Call JBCheb(X, 0.03725393, TJ, TJ1, Result)
        If Result > 0# Then
            Result = 0#
        End If
        JBTbl200 = Result
        Exit Function
    End If
    Result = -(0.1132404 * (S - 25#)) - 6.764034
    JBTbl200 = Result
End Function
Private Function JBTbl301(ByVal S As Double) As Double
    Dim Result As Double
    Dim X As Double
    Dim TJ As Double
    Dim TJ1 As Double
    Result = 0#
    If S <= 4# Then
        X = 2# * (S - 0#) / 4# - 1#
        TJ = 1#
        TJ1 = X
        Call JBCheb(X, -1.10429, TJ, TJ1, Result)
        Call JBCheb(X, -1.1258, TJ, TJ1, Result)
        Call JBCheb(X, -0.009595847, TJ, TJ1, Result)
        Call JBCheb(X, 0.01219666, TJ, TJ1, Result)
        Call JBCheb(X, 0.000150221, TJ, TJ1, Result)
        Call JBCheb(X, -0.00006414543, TJ, TJ1, Result)
        Call JBCheb(X, 0.00006754115, TJ, TJ1, Result)
        If Result > 0# Then
            Result = 0#
        End If
        JBTbl301 = Result
        Exit Function
    End If
    If S <= 15# Then
        X = 2# * (S - 4#) / 11# - 1#
        TJ = 1#
        TJ1 = X
        Call JBCheb(X, -4.065955, TJ, TJ1, Result)
        Call JBCheb(X, -1.58206, TJ, TJ1, Result)
        Call JBCheb(X, 0.2004472, TJ, TJ1, Result)
        Call JBCheb(X, -0.04709092, TJ, TJ1, Result)
        Call JBCheb(X, 0.01105779, TJ, TJ1, Result)
        Call JBCheb(X, 0.001197391, TJ, TJ1, Result)
        Call JBCheb(X, -0.000838678, TJ, TJ1, Result)
        If Result > 0# Then
            Result = 0#
        End If
        JBTbl301 = Result
        Exit Function
    End If
    If S <= 25# Then
        X = 2# * (S - 15#) / 10# - 1#
        TJ = 1#
        TJ1 = X
        Call JBCheb(X, -6.311384, TJ, TJ1, Result)
        Call JBCheb(X, -0.7918763, TJ, TJ1, Result)
        Call JBCheb(X, 0.03626584, TJ, TJ1, Result)
        If Result > 0# Then
            Result = 0#
        End If
        JBTbl301 = Result
        Exit Function
    End If
    Result = -(0.1293626 * (S - 25#)) - 7.066995
    JBTbl301 = Result
End Function
Private Function JBTbl501(ByVal S As Double) As Double
    Dim Result As Double
    Dim X As Double
    Dim TJ As Double
    Dim TJ1 As Double
    Result = 0#
    If S <= 4# Then
        X = 2# * (S - 0#) / 4# - 1#
        TJ = 1#
        TJ1 = X
        Call JBCheb(X, -1.067426, TJ, TJ1, Result)
        Call JBCheb(X, -1.079765, TJ, TJ1, Result)
        Call JBCheb(X, -0.005463005, TJ, TJ1, Result)
        Call JBCheb(X, 0.006875659, TJ, TJ1, Result)
        If Result > 0# Then
            Result = 0#
        End If
        JBTbl501 = Result
        Exit Function
    End If
    If S <= 15# Then
        X = 2# * (S - 4#) / 11# - 1#
        TJ = 1#
        TJ1 = X
        Call JBCheb(X, -4.127574, TJ, TJ1, Result)
        Call JBCheb(X, -1.740694, TJ, TJ1, Result)
        Call JBCheb(X, 0.2044502, TJ, TJ1, Result)
        Call JBCheb(X, -0.03746714, TJ, TJ1, Result)
        Call JBCheb(X, 0.0003810594, TJ, TJ1, Result)
        Call JBCheb(X, 0.001197111, TJ, TJ1, Result)
        If Result > 0# Then
            Result = 0#
        End If
        JBTbl501 = Result
        Exit Function
    End If
    If S <= 25# Then
        X = 2# * (S - 15#) / 10# - 1#
        TJ = 1#
        TJ1 = X
        Call JBCheb(X, -6.628194, TJ, TJ1, Result)
        Call JBCheb(X, -0.8846221, TJ, TJ1, Result)
        Call JBCheb(X, 0.04386405, TJ, TJ1, Result)
        If Result > 0# Then
            Result = 0#
        End If
        JBTbl501 = Result
        Exit Function
    End If
    Result = -(0.1418332 * (S - 25#)) - 7.468952
    JBTbl501 = Result
End Function
Private Function JBTbl701(ByVal S As Double) As Double
    Dim Result As Double
    Dim X As Double
    Dim TJ As Double
    Dim TJ1 As Double
    Result = 0#
    If S <= 4# Then
        X = 2# * (S - 0#) / 4# - 1#
        TJ = 1#
        TJ1 = X
        Call JBCheb(X, -1.050999, TJ, TJ1, Result)
        Call JBCheb(X, -1.059769, TJ, TJ1, Result)
        Call JBCheb(X, -0.00392268, TJ, TJ1, Result)
        Call JBCheb(X, 0.004847054, TJ, TJ1, Result)
        If Result > 0# Then
            Result = 0#
        End If
        JBTbl701 = Result
        Exit Function
    End If
    If S <= 15# Then
        X = 2# * (S - 4#) / 11# - 1#
        TJ = 1#
        TJ1 = X
        Call JBCheb(X, -4.192182, TJ, TJ1, Result)
        Call JBCheb(X, -1.860007, TJ, TJ1, Result)
        Call JBCheb(X, 0.1963942, TJ, TJ1, Result)
        Call JBCheb(X, -0.02838711, TJ, TJ1, Result)
        Call JBCheb(X, -0.0002893112, TJ, TJ1, Result)
        Call JBCheb(X, 0.002159788, TJ, TJ1, Result)
        If Result > 0# Then
            Result = 0#
        End If
        JBTbl701 = Result
        Exit Function
    End If
    If S <= 25# Then
        X = 2# * (S - 15#) / 10# - 1#
        TJ = 1#
        TJ1 = X
        Call JBCheb(X, -6.917851, TJ, TJ1, Result)
        Call JBCheb(X, -0.981702, TJ, TJ1, Result)
        Call JBCheb(X, 0.05383727, TJ, TJ1, Result)
        If Result > 0# Then
            Result = 0#
        End If
        JBTbl701 = Result
        Exit Function
    End If
    Result = -(0.1532706 * (S - 25#)) - 7.845715
    JBTbl701 = Result
End Function
Private Function JBTbl1401(ByVal S As Double) As Double
    Dim Result As Double
    Dim X As Double
    Dim TJ As Double
    Dim TJ1 As Double
    Result = 0#
    If S <= 4# Then
        X = 2# * (S - 0#) / 4# - 1#
        TJ = 1#
        TJ1 = X
        Call JBCheb(X, -1.026266, TJ, TJ1, Result)
        Call JBCheb(X, -1.030061, TJ, TJ1, Result)
        Call JBCheb(X, -0.001259222, TJ, TJ1, Result)
        Call JBCheb(X, 0.002536254, TJ, TJ1, Result)
        If Result > 0# Then
            Result = 0#
        End If
        JBTbl1401 = Result
        Exit Function
    End If
    If S <= 15# Then
        X = 2# * (S - 4#) / 11# - 1#
        TJ = 1#
        TJ1 = X
        Call JBCheb(X, -4.329849, TJ, TJ1, Result)
        Call JBCheb(X, -2.095443, TJ, TJ1, Result)
        Call JBCheb(X, 0.1759363, TJ, TJ1, Result)
        Call JBCheb(X, -0.007751359, TJ, TJ1, Result)
        Call JBCheb(X, -0.006124368, TJ, TJ1, Result)
        Call JBCheb(X, -0.001793114, TJ, TJ1, Result)
        If Result > 0# Then
            Result = 0#
        End If
        JBTbl1401 = Result
        Exit Function
    End If
    If S <= 25# Then
        X = 2# * (S - 15#) / 10# - 1#
        TJ = 1#
        TJ1 = X
        Call JBCheb(X, -7.54433, TJ, TJ1, Result)
        Call JBCheb(X, -1.225382, TJ, TJ1, Result)
        Call JBCheb(X, 0.05392349, TJ, TJ1, Result)
        If Result > 0# Then
            Result = 0#
        End If
        JBTbl1401 = Result
        Exit Function
    End If
    Result = -(0.2019375 * (S - 25#)) - 8.715788
    JBTbl1401 = Result
End Function
Private Sub JBCheb(ByVal X As Double, _
         ByVal C As Double, _
         ByRef TJ As Double, _
         ByRef TJ1 As Double, _
         ByRef R As Double)
    Dim T As Double
    R = R + C * TJ
    T = 2# * X * TJ1 - TJ
    TJ = TJ1
    TJ1 = T
End Sub

