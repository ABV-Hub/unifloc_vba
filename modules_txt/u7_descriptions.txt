Option Explicit
Sub Set_Descriptions()
On Error Resume Next
    Call Description_IPR
    Call Description
    Call Description_ESP_dP_atma
End Sub
Sub Description()
' функция определения описания функций и аргументо для интерфейса Excel
' достаточно вызвать один раз для того, чтобы поменять описание
' лучше вызывать функцию u7_descriptions.Задать_описания если надо поменять описания
              
    Dim P_atma, t_C, gamma_gas, gamma_oil, _
               gamma_wat, rsb_m3m3, Rp_m3m3, _
              Pb_atma, Tres_C, Bob_m3m3, Muob_cP, PVTcorr, Ksep_fr, PKsep_atma, _
              TKsep_C, Qliq_m3day, wc_perc, PVTstr, dPipe_mm, dChoke_mm, Pup_atma, Pdown_atma, fw_perc, _
                        Tchoke_C, Pin_atma, dIntake_mm, dCas_mm, Tin_C, P0_atma, P1_atma, Calc_from_P0
    Dim a, MF1, MF2, MFsep, MFchoke
    
    P_atma = "Давление расчета, атма"
    t_C = "Температура расчета, С"
    gamma_gas = "Относительная плотность газа, по воздуху (плотность воздуха 1.2217 кг/м3)"
    gamma_oil = "Относительная плотность нефти, по воде"
    gamma_wat = "Относительная плотность воды"
    rsb_m3m3 = "Газосодержание в нефти при давлении насыщения (в пластовых условиях), м3/м3"
    Rp_m3m3 = "Газовый фактор добычной (на устье скважины), м3/м3. имеет приоритет перед газосодержанием. Если Rp < Rsb то используется Rp"
    Pb_atma = "Давление насыщения при заданной температуре Tres_C, атма. Опциональный калибровочный параметр, если не задан или равен 0 то рассчитается по корреляции"
    Tres_C = "Температура пластовая (соответствует давлению насыщения), С"
    Bob_m3m3 = "Объемный коэффициент нефти при давлении насыщения, м3/м3. Опциональный калибровочный параметр, если не задан или равен 0 то рассчитается по корреляции"
    Muob_cP = "Вязкость нефти при давлении насыщения, сП. Опциональный калибровочный параметр, если не задан или равен 0 то рассчитается по корреляции"
    PVTcorr = "Набор PVT корреляций. 0 - на основе Стендинга, 1 - на основе Валко Маккейна"
    Ksep_fr = "Значение коэффициента сепарации. Модифицирует свойства флюида учитывая сепарацию части свободного газа. Опциональный настроечный параметр."
    PKsep_atma = "Давление при котором произошла сепарация части свободного газа, атма"
    TKsep_C = "Температура при которой произошла сепарация части свободного газа, С"
    PVTstr = "Закодированная строка с PVT параметрами. Должна быть закодирована функцией PVT_Encode_string"
    Qliq_m3day = "Дебит жидкости на поверхности, м3/сут"
    wc_perc = "Обводненность объемная на поверхности, %"
    dPipe_mm = "Диаметр трубы в которой установлен штуцер, мм"
    dChoke_mm = "Диаметр штуцера, мм"
    Pup_atma = "Давление вверх по потоку в штуцере. Давление на входе в штуцер, атма"
    Pdown_atma = "Давление вниз по потоку в штуцере. Давление на выходе из штуцера, атма"
    fw_perc = wc_perc
    Tchoke_C = "Температура потока в штуцере (на входе в штуцер)"
    Pin_atma = "Давление на приеме насоса. Давление сепарации"
    dIntake_mm = "Диаметр приемной сетки насоса"
    dCas_mm = "Диаметр эксплуатационной колонны"
    Tin_C = "Температура на приеме насоса"
    P0_atma = "Давление на входе в штуцер, аtma. Используется только при Calc_from_P0 = 1 "
    P1_atma = "Давление на выходе из штуцера, atma. Используется только при Calc_from_P0 = 0"
    Calc_from_P0 = "Направление расчета давления. " & _
                   "  Если 1 то исходя из давления на входе P0_atma рассчитывается давления на выходе. " & _
                   " При этом значение P1_atma игнорируется. И наоборот" ' & _
'                   " Если равно 0 то исходя из давления на выходе P1_atma рассчитывается давления на входе. " & _
'                   " При этом значение P0_atma игнорируется."
    
    a = Array(P_atma, t_C, gamma_gas, gamma_oil, _
              gamma_wat, rsb_m3m3, Rp_m3m3, _
              Pb_atma, Tres_C, Bob_m3m3, Muob_cP, PVTcorr, Ksep_fr, PKsep_atma, _
              TKsep_C, PVTstr)
              
    MF1 = Array(Qliq_m3day, wc_perc, P_atma, t_C, gamma_gas, gamma_oil, _
              gamma_wat, rsb_m3m3, Rp_m3m3, _
              Pb_atma, Tres_C, Bob_m3m3, Muob_cP, PVTcorr, Ksep_fr, PKsep_atma, _
              TKsep_C, PVTstr)
              
    Application.MacroOptions _
            Macro:="PVT_Encode_string", _
            Description:="Функция кодирования PVT данных в строку. Закодированную строку можно использовать для упрощенной передачи параметров функциям, которым необходимы данные PVT", _
            Category:="u7", _
            ArgumentDescriptions:=Array(gamma_gas, gamma_oil, gamma_wat, rsb_m3m3, Rp_m3m3, _
                                        Pb_atma, Tres_C, Bob_m3m3, Muob_cP, PVTcorr, Ksep_fr, PKsep_atma, TKsep_C)
              
    Application.MacroOptions _
            Macro:="PVT_Decode_string", _
            Description:="Функция раскодирования PVT строки в данные. Закодированную строку можно использовать для упрощенной передачи параметров функциям, которым необходимы данные PVT", _
            Category:="u7", _
            ArgumentDescriptions:=Array("PVT строка для раскодировки", "Флаг проверки раскодировки. Если 1, то возвращается повторно закодированная строка, если 0 - то возвращается PVT объект (применимо только в коде VBA)")
              
              
    Application.MacroOptions _
            Macro:="PVT_Bg_m3m3", _
            Description:="Расчет объемного коэффициента газа. Возвращает значение объемного коэффициента для заданных термобарических условий м3/м3. В основе расчета корреляция для z факотора", _
            Category:="u7", _
            ArgumentDescriptions:=a
            
    Application.MacroOptions _
            Macro:="PVT_Bo_m3m3", _
            Description:="Расчет объемного коэффициента нефти. Возвращает значение объемного коэффициента для заданных термобарических условий м3/м3. В основе расчета корреляции PVT для нелетучей нефти", _
            Category:="u7", _
            ArgumentDescriptions:=a
                        
    Application.MacroOptions _
            Macro:="PVT_Bw_m3m3", _
            Description:="Расчет объемного коэффициента воды. Возвращает значение объемного коэффициента для заданных термобарических условий м3/м3. В основе расчета корреляции PVT для воды", _
            Category:="u7", _
            ArgumentDescriptions:=a
                               
    Application.MacroOptions _
            Macro:="PVT_CJT_Katm", _
            Description:="Расчет коэффициента Джоуля Томсона для флюида при заданных термобарических условиях", _
            Category:="u7", _
            ArgumentDescriptions:=a
            
   Application.MacroOptions _
            Macro:="PVT_Muo_cP", _
            Description:="Расчет вязкости нефти при заданных термобарических условиях, сП", _
            Category:="u7", _
            ArgumentDescriptions:=a
         
    Application.MacroOptions _
            Macro:="PVT_Mug_cP", _
            Description:="Расчет вязкости газа при заданных термобарических условиях, сП", _
            Category:="u7", _
            ArgumentDescriptions:=a
    
    Application.MacroOptions _
            Macro:="PVT_Muw_cP", _
            Description:="Расчет вязкости воды при заданных термобарических условиях, сП", _
            Category:="u7", _
            ArgumentDescriptions:=a
     
    Application.MacroOptions _
            Macro:="PVT_Rs_m3m3", _
            Description:="Расчет газосодержания при заданных термобарических условиях, м3/м3", _
            Category:="u7", _
            ArgumentDescriptions:=a
            
    Application.MacroOptions _
            Macro:="PVT_Z", _
            Description:="Расчет коэффициента сверхсжимаемости газа при заданных условиях", _
            Category:="u7", _
            ArgumentDescriptions:=a
            
    Application.MacroOptions _
            Macro:="PVT_Rhoo_kgm3", _
            Description:="Расчет плотности нефти при заданных термобарических условиях, кг/м3", _
            Category:="u7", _
            ArgumentDescriptions:=a
            
    Application.MacroOptions _
            Macro:="PVT_Rhog_kgm3", _
            Description:="Расчет плотности газа при заданных термобарических условиях, кг/м3", _
            Category:="u7", _
            ArgumentDescriptions:=a
            
    Application.MacroOptions _
            Macro:="PVT_Rhow_kgm3", _
            Description:="Расчет плотности воды при заданных термобарических условиях, кг/м3", _
            Category:="u7", _
            ArgumentDescriptions:=a
     
    Application.MacroOptions _
            Macro:="PVT_Pb_atma", _
            Description:="Расчет давления насыщения, атма", _
            Category:="u7", _
            ArgumentDescriptions:=a
     
    Application.MacroOptions _
            Macro:="PVT_Sal_ppm", _
            Description:="Расчет солености воды, ppm", _
            Category:="u7", _
            ArgumentDescriptions:=a
     
    Application.MacroOptions _
            Macro:="MF_Mumix_cP", _
            Description:="Расчет вязкости газожидкостной смеси при заданных термобарических условиях, сП", _
            Category:="u7", _
            ArgumentDescriptions:=MF1
            
    Application.MacroOptions _
            Macro:="MF_Qmix_m3day", _
            Description:="Расчет объемного расхода газожидкостной смеси при заданных термобарических условиях, м3/сут", _
            Category:="u7", _
            ArgumentDescriptions:=MF1
            
    Application.MacroOptions _
            Macro:="MF_Rhomix_kgm3", _
            Description:="Расчет плотности газожидкостной смеси при заданных термобарических условиях, кг/м3", _
            Category:="u7", _
            ArgumentDescriptions:=MF1
     
              
    MF2 = Array(dPipe_mm, dChoke_mm, Pup_atma, Pdown_atma, fw_perc, _
                        Tchoke_C, _
                        gamma_gas, _
                        gamma_oil, _
                        gamma_wat, _
                        rsb_m3m3, _
                        Rp_m3m3, _
                        Pb_atma, _
                        Tres_C, _
                        Bob_m3m3, _
                        Muob_cP, _
                        PVTcorr, _
                        Ksep_fr, _
                        PKsep_atma, _
                        TKsep_C _
    )
    
    MFsep = Array(Pin_atma, _
        Qliq_m3day, fw_perc, _
         Tin_C, _
         dIntake_mm, _
         dCas_mm, _
                        gamma_gas, _
                        gamma_oil, _
                        gamma_wat, _
                        rsb_m3m3, _
                        Rp_m3m3, _
                        Pb_atma, _
                        Tres_C, _
                        Bob_m3m3, _
                        Muob_cP, _
                        PVTcorr, _
                        Ksep_fr, _
                        PKsep_atma, _
                        TKsep_C _
    )
    
    MFchoke = Array(dPipe_mm, dChoke_mm, _
            P0_atma, P1_atma, _
            Qliq_m3day, fw_perc, _
            Tchoke_C, _
            Calc_from_P0, _
            gamma_gas, _
            gamma_oil, _
            gamma_wat, _
            rsb_m3m3, _
            Rp_m3m3, _
            Pb_atma, _
            Tres_C, _
            Bob_m3m3, _
            Muob_cP, _
            PVTcorr, _
            Ksep_fr, _
            PKsep_atma, _
            TKsep_C)
    
    
    Application.MacroOptions _
            Macro:="MF_QChoke_m3day", _
            Description:="Расчет расхода флюида через штуцер при заданных термобарических условиях, м3/сут", _
            Category:="u7", _
            ArgumentDescriptions:=MF2
            
    Application.MacroOptions _
            Macro:="MF_SeparNat_d", _
            Description:="Расчет естественной сепарации газа в потоке на приеме насоса при заданных термобарических условиях, м3/сут", _
            Category:="u7", _
            ArgumentDescriptions:=MFsep
    
    Application.MacroOptions _
            Macro:="MF_dPChoke_atm", _
            Description:="Расчет перепада давление в штуцере при заданных термобарических условиях, м3/сут", _
            Category:="u7", _
            ArgumentDescriptions:=MFchoke
    
     
End Sub
Sub Description_IPR()
' функция определения описания функций и аргументо для интерфейса Excel
' достаточно вызвать один раз для того, чтобы поменять описание
' лучше вызывать функцию u7_descriptions.Задать_описания если надо поменять описания
              
    Dim Qtest_sm3day, Pwftest_atma, Pres_atma, fw_perc, Pb_atma
    Dim PI_sm3dayatm, Qliq_sm3day, Pwf_atma
    
    Dim IPR_PI_sm3dayatm, IPR_Pwf_atma, IPR_Qliq_sm3Day
    
    Qtest_sm3day = "Тестовый дебит жидкости на поверхности, м3/сут"
    Pwftest_atma = "Тестовое забойное давление, атма"
    Pres_atma = "Пластовое давление, атма"
    fw_perc = "Обводненность объемная на поверхности, %"
    Pb_atma = "Давление насыщения при заданной температуре Tres_C, атма. Опциональный калибровочный параметр, если не задан или равен 0 то рассчитается по корреляции"
    PI_sm3dayatm = "Коэффициент продуктивности пласта, м3/сут/атм"
    Qliq_sm3day = "Дебит жидкости на поверхности, м3/сут"
    Pwf_atma = "Забойное давление, атма"
    
    IPR_PI_sm3dayatm = Array( _
            Qtest_sm3day, _
            Pwftest_atma, _
            Pres_atma, _
            fw_perc, _
            Pb_atma)
    
    IPR_Pwf_atma = Array( _
            PI_sm3dayatm, _
            Pres_atma, _
            Qliq_sm3day, _
            fw_perc, _
            Pb_atma)
            
    IPR_Qliq_sm3Day = Array( _
            PI_sm3dayatm, _
            Pres_atma, _
            Pwf_atma, _
            fw_perc, _
            Pb_atma)
   
    Application.MacroOptions _
            Macro:="IPR_PI_sm3dayatm", _
            Description:="Расчет продуктивности скважины по тестовым данным по Вогелю", _
            Category:="u7", _
            ArgumentDescriptions:=IPR_PI_sm3dayatm
     
    Application.MacroOptions _
            Macro:="IPR_Pwf_atma", _
            Description:="Расчет забойного давления по известным значениям продуктивности и дебиту по Вогелю", _
            Category:="u7", _
            ArgumentDescriptions:=IPR_Pwf_atma
    
    Application.MacroOptions _
            Macro:="IPR_Qliq_sm3Day", _
            Description:="Расчет дебита жидкости по известным значениям продуктивности и дебиту по Вогелю", _
            Category:="u7", _
            ArgumentDescriptions:=IPR_Qliq_sm3Day
    
     
End Sub
Sub Description_ESP_dP_atma()
' функция определения описания для интерфейса Excel
' достаточно вызвать один раз для того, чтобы поменять описание
' лучше вызывать функцию u7_descriptions.Задать_описания если надо поменять описания
    Dim Pin_atma, Qliq_m3day, fw_perc, NumStages, freq_Hz, PumpID, _
            Tin_C, Tdis_C, CalcFromIntake, GasDegtType, Kdegr, _
            PVTstr, ESP_Power_fact_W, ESP_U_V, ESP_Motor_power_nom_kW, _
            ESP_cable_type, ESP_Hmes_m, mu_cSt
    Dim a, b
    Dim ESP_head_m
    
    Pin_atma = "Давление на приеме (или на выкиде если CalcFromIntake = 0), атма"
    Qliq_m3day = "Дебит жидкости на поверхности, м3/сут"
    fw_perc = "Обводненность объемная на поверхности, %"
    NumStages = "Количество ступеней УЭЦН"
    freq_Hz = "Частота вращения вала ЭЦН, Гц"
    PumpID = "Номер насоса в базе данных"
    Tin_C = "Температура на приеме насоса, С"
    Tdis_C = "Температура на выкиде насоса, С. Если = 0 и расчет от приема то рассчитывается, иначе учитывается то, что задано"
    CalcFromIntake = "Флаг показывает направление расчета 1 - от приема к выкиду, 0 от выкида к приему (иногда может считать медленнее)"
    GasDegtType = "Тип насоса для учета деградации по газу. 0 - не учитывается, 1 - стандартный, 2, 3, 4 с предвключенными модулями"
    Kdegr = "Коэффициент деградации напора"
    PVTstr = "Параметры флюидов закодированные в строку"
    ESP_Power_fact_W = "фактическое потребление мощности ЭЦН"
    ESP_U_V = "напряжение на высокой стороне на трансформаторе "
    ESP_Motor_power_nom_kW = "номинальная мощность двигателя"
    ESP_cable_type = "тип кабельной линии - тип 1: cable_R_Omkm = 1.18, cable_name = КПпАпБП-120 3x16, cable_Tmax_C = 120"
    ESP_Hmes_m = "длина кабельной линии"
    mu_cSt = "Вязкость жидкости перекачиваемой ЭЦН, сСт"
    
    b = Array(Qliq_m3day, fw_perc, Pin_atma, NumStages, freq_Hz, PumpID, PVTstr, _
              Tin_C, Tdis_C, CalcFromIntake, GasDegtType, Kdegr, ESP_Power_fact_W, ESP_U_V, _
              ESP_Motor_power_nom_kW, ESP_cable_type, ESP_Hmes_m)
    a = Array(Qliq_m3day, fw_perc, Pin_atma, NumStages, freq_Hz, PumpID, PVTstr, _
              Tin_C, Tdis_C, CalcFromIntake, GasDegtType, Kdegr)
              
    ESP_head_m = Array(Qliq_m3day, _
                       NumStages, _
                       freq_Hz, _
                       PumpID, _
                       mu_cSt)
              
    Application.MacroOptions _
            Macro:="ESP_dP_atm", _
            Description:="Расчет перепада давлений развиваемого УЭЦН. Возвращает перепад давления и перепад температур", _
            Category:="ESP", _
            ArgumentDescriptions:=a
            
    Application.MacroOptions _
            Macro:="ESP_system_calc", _
            Description:="расчет производительности системы УЭЦН, считает перепад давления, электрические параметры и деградацию КПД", _
            Category:="ESP", _
            ArgumentDescriptions:=b
    Application.MacroOptions _
            Macro:="ESP_head_m", _
            Description:="Функция выдает номинальный напор ЭЦН для заданных параметров (с учетом поправки на вязкость, если задана), м", _
            Category:="ESP", _
            ArgumentDescriptions:=ESP_head_m
    Application.MacroOptions _
            Macro:="ESP_Power_W", _
            Description:="Функция выдает номинальную мощность постребляемую ЭЦН с вала для заданных параметров (с учетом поправки на вязкость, если задана), м", _
            Category:="ESP", _
            ArgumentDescriptions:=ESP_head_m
            
    Application.MacroOptions _
            Macro:="ESP_eff_fr", _
            Description:="Функция выдает номинальный КПД ЭЦН для заданных параметров (с учетом поправки на вязкость, если задана), м", _
            Category:="ESP", _
            ArgumentDescriptions:=ESP_head_m
    
    Application.MacroOptions _
            Macro:="ESP_name", _
            Description:="Функция выдает название насоса в базе данных", _
            Category:="ESP", _
            ArgumentDescriptions:=Array(PumpID)
            
    Application.MacroOptions _
            Macro:="esp_maxRate_m3day", _
            Description:="Функция возвращает значение максимального номинального дебита на заданной частоте", _
            Category:="ESP", _
            ArgumentDescriptions:=Array(freq_Hz, PumpID)
            
    Application.MacroOptions _
            Macro:="ESP_optRate_m3day", _
            Description:="Функция возвращает значение оптимального номинального дебита на заданной частоте", _
            Category:="ESP", _
            ArgumentDescriptions:=Array(freq_Hz, PumpID)
            
    Application.MacroOptions _
            Macro:="ESP_IDbyRate", _
            Description:="Функция идентификатор насоса в базе данных для заданного дебита (номер типового насоса)", _
            Category:="ESP", _
            ArgumentDescriptions:=Array("Номинальный дебит насоса - типоразмер")
            
            
End Sub
