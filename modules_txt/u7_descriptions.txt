Option Explicit
Sub Set_Descriptions()
On Error Resume Next
    Call Description_IPR
    Call Description_PVT
    Call Description_MF
    Call Description_ESP_dP_atma
    Call Description_crv
    Call Description_well
End Sub
Sub Description_PVT()
' функция определения описания функций и аргументо для интерфейса Excel
' достаточно вызвать один раз для того, чтобы поменять описание
' лучше вызывать функцию u7_descriptions.Задать_описания если надо поменять описания
On Error Resume Next
    Dim p_atma, t_C, gamma_gas, gamma_oil
    Dim gamma_wat, rsb_m3m3, rp_m3m3
    Dim pb_atma, tres_C, bob_m3m3
    Dim muob_cP, PVTcorr, ksep_fr, pksep_atma
    Dim tksep_C, qliq_m3day, fw_perc, PVTstr
    Dim d_pipe_mm, dchoke_mm, Pup_atma, Pdown_atma
    Dim Tchoke_C, p_intake_atma, d_intake_mm, d_cas_mm, t_intake_C, P0_atma, P1_atma, calc_from_P0
    Dim A, MF1, MF2, MFsep, MFchoke
    
    p_atma = "Давление расчета, атма"
    t_C = "Температура расчета, С"
    gamma_gas = "Относительная плотность газа, по воздуху (плотность воздуха 1.2217 кг/м3)"
    gamma_oil = "Относительная плотность нефти, по воде"
    gamma_wat = "Относительная плотность воды"
    rsb_m3m3 = "Газосодержание в нефти при давлении насыщения (в пластовых условиях), м3/м3"
    rp_m3m3 = "Газовый фактор добычной (на устье скважины), м3/м3. имеет приоритет перед газосодержанием. Если Rp < rsb то используется Rp"
    pb_atma = "Давление насыщения при заданной температуре tres_C, атма. Опциональный калибровочный параметр, если не задан или равен 0 то рассчитается по корреляции"
    tres_C = "Температура пластовая (соответствует давлению насыщения), С"
    bob_m3m3 = "Объемный коэффициент нефти при давлении насыщения, м3/м3. Опциональный калибровочный параметр, если не задан или равен 0 то рассчитается по корреляции"
    muob_cP = "Вязкость нефти при давлении насыщения, сП. Опциональный калибровочный параметр, если не задан или равен 0 то рассчитается по корреляции"
    PVTcorr = "Набор PVT корреляций. 0 - на основе Стендинга, 1 - на основе Валко Маккейна"
    ksep_fr = "Значение коэффициента сепарации. Модифицирует свойства флюида учитывая сепарацию части свободного газа. Опциональный настроечный параметр."
    pksep_atma = "Давление при котором произошла сепарация части свободного газа, атма"
    tksep_C = "Температура при которой произошла сепарация части свободного газа, С"
    PVTstr = "Закодированная строка с PVT параметрами. Должна быть закодирована функцией PVT_encode_string"
    qliq_m3day = "Дебит жидкости на поверхности, м3/сут"
    fw_perc = "Обводненность объемная на поверхности, %"
    d_pipe_mm = "Диаметр трубы в которой установлен штуцер, мм"
    dchoke_mm = "Диаметр штуцера, мм"
    Pup_atma = "Давление вверх по потоку в штуцере. Давление на входе в штуцер, атма"
    Pdown_atma = "Давление вниз по потоку в штуцере. Давление на выходе из штуцера, атма"
    fw_perc = fw_perc
    Tchoke_C = "Температура потока в штуцере (на входе в штуцер)"
    p_intake_atma = "Давление на приеме насоса. Давление сепарации"
    d_intake_mm = "Диаметр приемной сетки насоса"
    d_cas_mm = "Диаметр эксплуатационной колонны"
    t_intake_C = "Температура на приеме насоса"
    P0_atma = "Давление на входе в штуцер, аtma. Используется только при calc_from_P0 = 1 "
    P1_atma = "Давление на выходе из штуцера, atma. Используется только при calc_from_P0 = 0"
    calc_from_P0 = "Направление расчета давления. " & _
                   "  Если 1 то исходя из давления на входе P0_atma рассчитывается давления на выходе. " & _
                   " При этом значение P1_atma игнорируется. И наоборот" ' & _
'                   " Если равно 0 то исходя из давления на выходе P1_atma рассчитывается давления на входе. " & _
'                   " При этом значение P0_atma игнорируется."
    
    A = Array(p_atma, t_C, gamma_gas, gamma_oil, _
              gamma_wat, rsb_m3m3, rp_m3m3, _
              pb_atma, tres_C, bob_m3m3, muob_cP, PVTcorr, ksep_fr, pksep_atma, _
              tksep_C, PVTstr)
              
              
    Application.MacroOptions _
            Macro:="PVT_encode_string", _
            Description:="Функция кодирования PVT данных в строку. Закодированную строку можно использовать для упрощенной передачи параметров функциям, которым необходимы данные PVT", _
            Category:="u7", _
            ArgumentDescriptions:=Array(gamma_gas, gamma_oil, gamma_wat, rsb_m3m3, rp_m3m3, _
                                        pb_atma, tres_C, bob_m3m3, muob_cP, PVTcorr, ksep_fr, pksep_atma, tksep_C)
              
    Application.MacroOptions _
            Macro:="PVT_decode_string", _
            Description:="Функция раскодирования PVT строки в данные. Закодированную строку можно использовать для упрощенной передачи параметров функциям, которым необходимы данные PVT", _
            Category:="u7", _
            ArgumentDescriptions:=Array("PVT строка для раскодировки", "Флаг проверки раскодировки. Если 1, то возвращается повторно закодированная строка, если 0 - то возвращается PVT объект (применимо только в коде VBA)")
              
              
    Application.MacroOptions _
            Macro:="PVT_bg_m3m3", _
            Description:="Расчет объемного коэффициента газа. Возвращает значение объемного коэффициента для заданных термобарических условий м3/м3. В основе расчета корреляция для z факотора", _
            Category:="u7", _
            ArgumentDescriptions:=A
            
    Application.MacroOptions _
            Macro:="PVT_bo_m3m3", _
            Description:="Расчет объемного коэффициента нефти. Возвращает значение объемного коэффициента для заданных термобарических условий м3/м3. В основе расчета корреляции PVT для нелетучей нефти", _
            Category:="u7", _
            ArgumentDescriptions:=A
                        
    Application.MacroOptions _
            Macro:="PVT_bw_m3m3", _
            Description:="Расчет объемного коэффициента воды. Возвращает значение объемного коэффициента для заданных термобарических условий м3/м3. В основе расчета корреляции PVT для воды", _
            Category:="u7", _
            ArgumentDescriptions:=A
                               
    Application.MacroOptions _
            Macro:="PVT_CJT_Katm", _
            Description:="Расчет коэффициента Джоуля Томсона для флюида при заданных термобарических условиях", _
            Category:="u7", _
            ArgumentDescriptions:=A
            
   Application.MacroOptions _
            Macro:="PVT_mu_oil_cP", _
            Description:="Расчет вязкости нефти при заданных термобарических условиях, сП", _
            Category:="u7", _
            ArgumentDescriptions:=A
         
    Application.MacroOptions _
            Macro:="PVT_mu_gas_cP", _
            Description:="Расчет вязкости газа при заданных термобарических условиях, сП", _
            Category:="u7", _
            ArgumentDescriptions:=A
    
    Application.MacroOptions _
            Macro:="PVT_mu_wat_cP", _
            Description:="Расчет вязкости воды при заданных термобарических условиях, сП", _
            Category:="u7", _
            ArgumentDescriptions:=A
     
    Application.MacroOptions _
            Macro:="PVT_rs_m3m3", _
            Description:="Расчет газосодержания при заданных термобарических условиях, м3/м3", _
            Category:="u7", _
            ArgumentDescriptions:=A
            
    Application.MacroOptions _
            Macro:="PVT_Z", _
            Description:="Расчет коэффициента сверхсжимаемости газа при заданных условиях", _
            Category:="u7", _
            ArgumentDescriptions:=A
            
    Application.MacroOptions _
            Macro:="PVT_rhoo_kgm3", _
            Description:="Расчет плотности нефти при заданных термобарических условиях, кг/м3", _
            Category:="u7", _
            ArgumentDescriptions:=A
            
    Application.MacroOptions _
            Macro:="PVT_rhog_kgm3", _
            Description:="Расчет плотности газа при заданных термобарических условиях, кг/м3", _
            Category:="u7", _
            ArgumentDescriptions:=A
            
    Application.MacroOptions _
            Macro:="PVT_Rhow_kgm3", _
            Description:="Расчет плотности воды при заданных термобарических условиях, кг/м3", _
            Category:="u7", _
            ArgumentDescriptions:=A
     
    Application.MacroOptions _
            Macro:="PVT_pb_atma", _
            Description:="Расчет давления насыщения, атма", _
            Category:="u7", _
            ArgumentDescriptions:=Array(t_C, gamma_gas, gamma_oil, _
              gamma_wat, rsb_m3m3, rp_m3m3, _
              pb_atma, tres_C, bob_m3m3, muob_cP, PVTcorr, ksep_fr, pksep_atma, _
              tksep_C, PVTstr)
     
    Application.MacroOptions _
            Macro:="PVT_salinity_ppm", _
            Description:="Расчет солености воды, ppm", _
            Category:="u7", _
            ArgumentDescriptions:=A
    Application.MacroOptions _
            Macro:="PVT_STliqgas_Nm", _
            Description:="Расчет поверхностного натяжения на границе фаз жидкость - газ, Нм", _
            Category:="u7", _
            ArgumentDescriptions:=A
    Application.MacroOptions _
            Macro:="PVT_SToilgas_Nm", _
            Description:="Расчет поверхностного натяжения на границе фаз нефть - газ, Нм", _
            Category:="u7", _
            ArgumentDescriptions:=A
    Application.MacroOptions _
            Macro:="PVT_STwatgas_Nm", _
            Description:="Расчет поверхностного натяжения на границе фаз вода - газ, Нм", _
            Category:="u7", _
            ArgumentDescriptions:=A
End Sub
     
Sub Description_MF()
' функция определения описания функций и аргументо для интерфейса Excel
' достаточно вызвать один раз для того, чтобы поменять описание
' лучше вызывать функцию u7_descriptions.Задать_описания если надо поменять описания
On Error Resume Next
    Dim p_atma, t_C, gamma_gas, gamma_oil, _
               gamma_wat, rsb_m3m3, rp_m3m3, _
              pb_atma, tres_C, bob_m3m3, muob_cP, PVTcorr, ksep_fr, pksep_atma, _
              tksep_C, qliq_m3day, fw_perc, PVTstr, d_pipe_mm, dchoke_mm, Pup_atma, Pdown_atma, _
                        Tchoke_C, p_intake_atma, d_intake_mm, d_cas_mm, t_intake_C, P0_atma, P1_atma, calc_from_P0
    Dim A, MF1, MF2, MFsep, MFchoke, MFchoke2
    Dim FreeGas_d
    
    FreeGas_d = "Доля свободного газа в потоке, безразмерная величина"
    p_atma = "Давление расчета, атма"
    t_C = "Температура расчета, С"
    gamma_gas = "Относительная плотность газа, по воздуху (плотность воздуха 1.2217 кг/м3)"
    gamma_oil = "Относительная плотность нефти, по воде"
    gamma_wat = "Относительная плотность воды"
    rsb_m3m3 = "Газосодержание в нефти при давлении насыщения (в пластовых условиях), м3/м3"
    rp_m3m3 = "Газовый фактор добычной (на устье скважины), м3/м3. имеет приоритет перед газосодержанием. Если Rp < rsb то используется Rp"
    pb_atma = "Давление насыщения при заданной температуре tres_C, атма. Опциональный калибровочный параметр, если не задан или равен 0 то рассчитается по корреляции"
    tres_C = "Температура пластовая (соответствует давлению насыщения), С"
    bob_m3m3 = "Объемный коэффициент нефти при давлении насыщения, м3/м3. Опциональный калибровочный параметр, если не задан или равен 0 то рассчитается по корреляции"
    muob_cP = "Вязкость нефти при давлении насыщения, сП. Опциональный калибровочный параметр, если не задан или равен 0 то рассчитается по корреляции"
    PVTcorr = "Набор PVT корреляций. 0 - на основе Стендинга, 1 - на основе Валко Маккейна"
    ksep_fr = "Значение коэффициента сепарации. Модифицирует свойства флюида учитывая сепарацию части свободного газа. Опциональный настроечный параметр."
    pksep_atma = "Давление при котором произошла сепарация части свободного газа, атма"
    tksep_C = "Температура при которой произошла сепарация части свободного газа, С"
    PVTstr = "Закодированная строка с PVT параметрами. Должна быть закодирована функцией PVT_encode_string"
    qliq_m3day = "Дебит жидкости на поверхности, м3/сут"
    fw_perc = "Обводненность объемная на поверхности, %"
    d_pipe_mm = "Диаметр трубы в которой установлен штуцер, мм"
    dchoke_mm = "Диаметр штуцера, мм"
    Pup_atma = "Давление вверх по потоку в штуцере. Давление на входе в штуцер, атма"
    Pdown_atma = "Давление вниз по потоку в штуцере. Давление на выходе из штуцера, атма"
    Dim p_in_atma, p_out_atma
    p_in_atma = Pup_atma
    p_out_atma = Pdown_atma
    fw_perc = fw_perc
    Tchoke_C = "Температура потока в штуцере (на входе в штуцер)"
    p_intake_atma = "Давление на приеме насоса. Давление сепарации"
    d_intake_mm = "Диаметр приемной сетки насоса"
    d_cas_mm = "Диаметр эксплуатационной колонны"
    t_intake_C = "Температура на приеме насоса"
    P0_atma = "Давление на входе в штуцер, аtma. Используется только при calc_from_P0 = 1 "
    P1_atma = "Давление на выходе из штуцера, atma. Используется только при calc_from_P0 = 0"
    calc_from_P0 = "Направление расчета давления. " & _
                   "  Если 1 то исходя из давления на входе P0_atma рассчитывается давления на выходе. " & _
                   " При этом значение P1_atma игнорируется. И наоборот" ' & _
'                   " Если равно 0 то исходя из давления на выходе P1_atma рассчитывается давления на входе. " & _
'                   " При этом значение P0_atma игнорируется."
    Dim Pcalc
    Pcalc = "Давление на границе гидравлического элемента. Граничное условие для расчета"
    Dim calc_along_flow
    calc_along_flow = "Флаг направления расчета относительно потока. если = 1 то расчет по потоку, ищется линейное давление по известному буферному , если = 0 то расчет против потока "
    Dim cfChoke
    cfChoke = "поправочный коэффициент на штуцер"
    
    MFchoke = Array(qliq_m3day, fw_perc, _
                    dchoke_mm, _
                    Pcalc, _
                    calc_along_flow, _
                    d_pipe_mm, _
                    Tchoke_C, _
                    cfChoke, _
                    PVTstr)
    
    Application.MacroOptions _
            Macro:="MF_p_choke_atma", _
            Description:="Расчет давления на границе штуцера при заданных условиях, атма", _
            Category:="u7", _
            ArgumentDescriptions:=MFchoke
            
    
    Application.MacroOptions _
            Macro:="MF_dp_choke_atm", _
            Description:="Расчет перепада давления в штуцере штуцера при заданных условиях, атма", _
            Category:="u7", _
            ArgumentDescriptions:=MFchoke
    
    MFchoke2 = Array(fw_perc, _
                    dchoke_mm, _
                    p_in_atma, _
                    p_out_atma, _
                    d_pipe_mm, _
                    Tchoke_C, _
                    cfChoke, _
                    PVTstr)
    
    Application.MacroOptions _
            Macro:="MF_qliq_choke_sm3day", _
            Description:="Расчет расхода флюида через штуцер при заданных термобарических условиях, м3/сут", _
            Category:="u7", _
            ArgumentDescriptions:=MFchoke2
            
    Application.MacroOptions _
            Macro:="MF_cf_choke_fr", _
            Description:="Расчет корректировочного коэффициента для характеристики штуцера, на основе согласования с замерами дебита и давления на входе и выходе.", _
            Category:="u7", _
            ArgumentDescriptions:=Array(qliq_m3day, _
                                        fw_perc, _
                                        dchoke_mm, _
                                        p_in_atma, _
                                        p_out_atma, _
                                        d_pipe_mm, _
                                        Tchoke_C, _
                                        cfChoke, _
                                        PVTstr)
            
            
    Application.MacroOptions _
            Macro:="MF_ksep_natural_d", _
            Description:="Расчет естественной сепарации газа в потоке на приеме насоса при заданных термобарических условиях, доли единиц", _
            Category:="u7", _
            ArgumentDescriptions:=Array(qliq_m3day, _
                                        fw_perc, _
                                        p_intake_atma, _
                                        t_intake_C, _
                                        d_intake_mm, _
                                        d_cas_mm, _
                                        PVTstr)
    Application.MacroOptions _
            Macro:="MF_ksep_total_d", _
            Description:="Расчет общего коэффициента сепарации газа в потоке на приеме насоса при заданных термобарических условиях." & _
                         " Общий коэффициент сепарации склдывается из искуственной и естественной сепарации. Доли единиц", _
            Category:="u7", _
            ArgumentDescriptions:=Array("Коэффициент естесвенной сепарации газа на приеме насоса, д.е.", _
                                        "Коэффициент искуственной сепарации газа за счет газосепаратора, д.е.")
              
    Application.MacroOptions _
            Macro:="MF_ksep_gasseparator_d", _
            Description:="Расчет искуственного коэффициента сепарации газа в потоке на приеме насоса при заданных термобарических условиях." & _
                         "Коэффициент сепарации газа газосепаратора. Основан на данных лабораторных испытаний РГУ нефти и газа имени И.М. Губкина. Доли единиц", _
            Category:="u7", _
            ArgumentDescriptions:=Array("Тип газосепаратора. Номер от 1 до 18 - соответсвует разным типам газосепаратора. 2 - хороший вариант", _
                                        "Доля газа в потоке на приеме газосепаратора", _
                                        "Дебит жидкости через газосепатор в поверхностных условиях, м3/сут", _
                                        "Частота вращения вала газосепаратора. Опциональный. По умолчанию принята 50 Гц")
              
              
              
    MF1 = Array(qliq_m3day, fw_perc, p_atma, t_C, PVTstr)
    Application.MacroOptions _
            Macro:="MF_mu_mix_cP", _
            Description:="Расчет вязкости газожидкостной смеси при заданных термобарических условиях, сП", _
            Category:="u7", _
            ArgumentDescriptions:=MF1
            
    Application.MacroOptions _
            Macro:="MF_q_mix_rc_m3day", _
            Description:="Расчет объемного расхода газожидкостной смеси при заданных термобарических условиях, м3/сут", _
            Category:="u7", _
            ArgumentDescriptions:=MF1
            
    Application.MacroOptions _
            Macro:="MF_rhomix_kgm3", _
            Description:="Расчет плотности газожидкостной смеси при заданных термобарических условиях, кг/м3", _
            Category:="u7", _
            ArgumentDescriptions:=MF1
     
    Application.MacroOptions _
            Macro:="MF_rp_gas_fraction_m3m3", _
            Description:="Расчет газового фактора при котором достигается заданная доля свободного газа в потоке, м3/м3", _
            Category:="u7", _
            ArgumentDescriptions:=Array(FreeGas_d, p_atma, t_C, fw_perc, PVTstr)
 
     Application.MacroOptions _
            Macro:="MF_p_gas_fraction_atma", _
            Description:="Расчет давления при котором достигается заданная доля свободного газа в потоке, м3/м3", _
            Category:="u7", _
            ArgumentDescriptions:=Array(FreeGas_d, t_C, fw_perc, PVTstr)
  
      Application.MacroOptions _
            Macro:="MF_gas_fraction_d", _
            Description:="Расчет объемной доли свободного газа в потоке, безразмерная величина", _
            Category:="u7", _
            ArgumentDescriptions:=Array(p_atma, t_C, fw_perc, PVTstr)
 
       Application.MacroOptions _
            Macro:="MF_p_pipe_atma", _
            Description:="Расчет давления в трубе по многофазной корреляции", _
            Category:="u7", _
            ArgumentDescriptions:=Array(qliq_m3day, _
                                        fw_perc, _
                                        "Координата начального конца трубы. Давление задается для начального участка трубы", _
                                        "Координата конца трубы противоположного начальному", _
                                        "Давление на конце трубы. Граничное значение давления, атма", _
                                        PVTstr, _
                                        "Угол наклона трубы к горизонтали, градусы", _
                                        "Внутренний диаметр трубы", _
                                        "Гидравлическая многофазная корреляция. 0 - Беггса Брилла, 1 - ансари", _
                                        "Температура на конце трубы где задано давление, С", _
                                        "Температура на противоположном конце трубы (по отношению к тому где задано давление), С", _
                                        "Корректировочный коэффициент (множитель) для расчета гравитационной составляющей градиента давления. По умолчанию = 1 - отсутвие корректировки. д.е", _
                                        "Корректировочный коэффициент (множитель) для расчета составляющей трения градиента давления. По умолчанию = 1 - отсутвие корректировки. д.е", _
                                        "Шероховатость стенок трубы, мм")
       Application.MacroOptions _
            Macro:="MF_dp_pipe_atm", _
            Description:="Расчет перепада давления в трубе по многофазной корреляции", _
            Category:="u7", _
            ArgumentDescriptions:=Array(qliq_m3day, _
                                        fw_perc, _
                                        "Координата начального конца трубы. Давление задается для начального участка трубы", _
                                        "Координата конца трубы противоположного начальному", _
                                        "Давление на конце трубы. Граничное значение давления, атма", _
                                        PVTstr, _
                                        "Угол наклона трубы к горизонтали, градусы", _
                                        "Внутренний диаметр трубы", _
                                        "Гидравлическая многофазная корреляция. 0 - Беггса Брилла, 1 - ансари", _
                                        "Температура на конце трубы где задано давление, С", _
                                        "Температура на противоположном конце трубы (по отношению к тому где задано давление), С", _
                                        "Корректировочный коэффициент (множитель) для расчета гравитационной составляющей градиента давления. По умолчанию = 1 - отсутвие корректировки. д.е", _
                                        "Корректировочный коэффициент (множитель) для расчета составляющей трения градиента давления. По умолчанию = 1 - отсутвие корректировки. д.е", _
                                        "Шероховатость стенок трубы, мм")
        Application.MacroOptions _
            Macro:="MF_p_pipe_znlf_atma", _
            Description:="Расчет давления в трубе с неподвижной жидкостью и поток газа через нее (барботаж, Zero Net Liquid Flow)", _
            Category:="u7", _
            ArgumentDescriptions:=Array(qliq_m3day, _
                                        fw_perc, _
                                        "Координата начального конца трубы. Давление задается для начального участка трубы", _
                                        "Координата конца трубы противоположного начальному", _
                                        "Давление на конце трубы. Граничное значение давления, атма", _
                                        PVTstr, _
                                        "Угол наклона трубы к горизонтали, градусы", _
                                        "Внутренний диаметр трубы", _
                                        "Гидравлическая многофазная корреляция. Не влияет для бартотажа. Расчет ведется на основе Ансари", _
                                        "Температура на конце трубы где задано давление, С", _
                                        "Температура на противоположном конце трубы (по отношению к тому где задано давление), С", _
                                        "Корректировочный коэффициент (множитель) для расчета гравитационной составляющей градиента давления. По умолчанию = 1 - отсутвие корректировки. д.е", _
                                        "Корректировочный коэффициент (множитель) для расчета составляющей трения градиента давления. По умолчанию = 1 - отсутвие корректировки. д.е", _
                                        "Шероховатость стенок трубы, мм", _
                                        "Расход свободного газа через трубу,  с.у. м3/сут  ")
              
    MF2 = Array(d_pipe_mm, dchoke_mm, Pup_atma, Pdown_atma, fw_perc, _
                        Tchoke_C, _
                        gamma_gas, _
                        gamma_oil, _
                        gamma_wat, _
                        rsb_m3m3, _
                        rp_m3m3, _
                        pb_atma, _
                        tres_C, _
                        bob_m3m3, _
                        muob_cP, _
                        PVTcorr, _
                        ksep_fr, _
                        pksep_atma, _
                        tksep_C _
    )
    
    MFsep = Array(p_intake_atma, _
        qliq_m3day, fw_perc, _
         t_intake_C, _
         d_intake_mm, _
         d_cas_mm, _
                        gamma_gas, _
                        gamma_oil, _
                        gamma_wat, _
                        rsb_m3m3, _
                        rp_m3m3, _
                        pb_atma, _
                        tres_C, _
                        bob_m3m3, _
                        muob_cP, _
                        PVTcorr, _
                        ksep_fr, _
                        pksep_atma, _
                        tksep_C _
    )
    
     
End Sub
Sub Description_IPR()
' функция определения описания функций и аргументо для интерфейса Excel
' достаточно вызвать один раз для того, чтобы поменять описание
' лучше вызывать функцию u7_descriptions.Задать_описания если надо поменять описания
On Error Resume Next
    Dim Qtest_sm3day, Pwftest_atma, Pres_atma, fw_perc, pb_atma
    Dim pi_sm3dayatm, qliq_sm3day, pwf_atma
    
    Dim IPR_pi_sm3dayatm, IPR_pwf_atma, IPR_qliq_sm3day
    
    Qtest_sm3day = "Тестовый дебит жидкости на поверхности, м3/сут"
    Pwftest_atma = "Тестовое забойное давление, атма"
    Pres_atma = "Пластовое давление, атма"
    fw_perc = "Обводненность объемная на поверхности, %"
    pb_atma = "Давление насыщения при заданной температуре tres_C, атма. Опциональный калибровочный параметр, если не задан или равен 0 то рассчитается по корреляции"
    pi_sm3dayatm = "Коэффициент продуктивности пласта, м3/сут/атм"
    qliq_sm3day = "Дебит жидкости на поверхности, м3/сут"
    pwf_atma = "Забойное давление, атма"
    
    IPR_pi_sm3dayatm = Array( _
            Qtest_sm3day, _
            Pwftest_atma, _
            Pres_atma, _
            fw_perc, _
            pb_atma)
    
    IPR_pwf_atma = Array( _
            pi_sm3dayatm, _
            Pres_atma, _
            qliq_sm3day, _
            fw_perc, _
            pb_atma)
            
    IPR_qliq_sm3day = Array( _
            pi_sm3dayatm, _
            Pres_atma, _
            pwf_atma, _
            fw_perc, _
            pb_atma)
   
    Application.MacroOptions _
            Macro:="IPR_pi_sm3dayatm", _
            Description:="Расчет продуктивности скважины по тестовым данным по Вогелю", _
            Category:="u7", _
            ArgumentDescriptions:=IPR_pi_sm3dayatm
     
    Application.MacroOptions _
            Macro:="IPR_pwf_atma", _
            Description:="Расчет забойного давления по известным значениям продуктивности и дебиту по Вогелю", _
            Category:="u7", _
            ArgumentDescriptions:=IPR_pwf_atma
    
    Application.MacroOptions _
            Macro:="IPR_qliq_sm3day", _
            Description:="Расчет дебита жидкости по известным значениям продуктивности и дебиту по Вогелю", _
            Category:="u7", _
            ArgumentDescriptions:=IPR_qliq_sm3day
    
     
End Sub
Sub Description_ESP_dP_atma()
' функция определения описания для интерфейса Excel
' достаточно вызвать один раз для того, чтобы поменять описание
' лучше вызывать функцию u7_descriptions.Задать_описания если надо поменять описания
    Dim p_intake_atma, qliq_m3day, fw_perc, num_stages, freq_Hz, pump_id, _
            t_intake_C, Tdis_C, CalcFromIntake, GasDegtType, Kdegr, _
            PVTstr, ESP_power_fact_W, ESP_U_V, ESP_Motor_power_nom_kW, _
            ESP_cable_type, ESP_Hmes_m, mu_cSt
    Dim A, B
    Dim ESP_head_m
On Error Resume Next
    p_intake_atma = "Давление на приеме (или на выкиде если CalcFromIntake = 0), атма"
    qliq_m3day = "Дебит жидкости на поверхности, м3/сут"
    fw_perc = "Обводненность объемная на поверхности, %"
    num_stages = "Количество ступеней УЭЦН"
    freq_Hz = "Частота вращения вала ЭЦН, Гц"
    pump_id = "Номер насоса в базе данных"
    t_intake_C = "Температура на приеме насоса, С"
    Tdis_C = "Температура на выкиде насоса, С. Если = 0 и расчет от приема то рассчитывается, иначе учитывается то, что задано"
    CalcFromIntake = "Флаг показывает направление расчета 1 - от приема к выкиду, 0 от выкида к приему (иногда может считать медленнее)"
    GasDegtType = "Тип насоса для учета деградации по газу. 0 - не учитывается, 1 - стандартный, 2, 3, 4 с предвключенными модулями"
    Kdegr = "Коэффициент деградации напора"
    PVTstr = "Параметры флюидов закодированные в строку"
    ESP_power_fact_W = "фактическое потребление мощности ЭЦН"
    ESP_U_V = "напряжение на высокой стороне на трансформаторе "
    ESP_Motor_power_nom_kW = "номинальная мощность двигателя"
    ESP_cable_type = "тип кабельной линии - тип 1: cable_R_Omkm = 1.18, cable_name = КПпАпБП-120 3x16, cable_Tmax_C = 120"
    ESP_Hmes_m = "длина кабельной линии"
    mu_cSt = "Вязкость жидкости перекачиваемой ЭЦН, сСт"
    
    B = Array(qliq_m3day, fw_perc, p_intake_atma, num_stages, freq_Hz, pump_id, PVTstr, _
              t_intake_C, Tdis_C, CalcFromIntake, GasDegtType, Kdegr, ESP_power_fact_W, ESP_U_V, _
              ESP_Motor_power_nom_kW, ESP_cable_type, ESP_Hmes_m)
    A = Array(qliq_m3day, fw_perc, p_intake_atma, num_stages, freq_Hz, pump_id, PVTstr, _
              t_intake_C, Tdis_C, CalcFromIntake, GasDegtType, Kdegr)
              
    ESP_head_m = Array(qliq_m3day, _
                       num_stages, _
                       freq_Hz, _
                       pump_id, _
                       mu_cSt)
              
    Application.MacroOptions _
            Macro:="ESP_dp_atm", _
            Description:="Расчет перепада давлений развиваемого УЭЦН. Возвращает перепад давления и перепад температур", _
            Category:="ESP", _
            ArgumentDescriptions:=A
            
    Application.MacroOptions _
            Macro:="ESP_system_calc", _
            Description:="расчет производительности системы УЭЦН, считает перепад давления, электрические параметры и деградацию КПД", _
            Category:="ESP", _
            ArgumentDescriptions:=B
    Application.MacroOptions _
            Macro:="ESP_head_m", _
            Description:="Функция выдает номинальный напор ЭЦН для заданных параметров (с учетом поправки на вязкость, если задана), м", _
            Category:="ESP", _
            ArgumentDescriptions:=ESP_head_m
    Application.MacroOptions _
            Macro:="ESP_power_W", _
            Description:="Функция выдает номинальную мощность постребляемую ЭЦН с вала для заданных параметров (с учетом поправки на вязкость, если задана), м", _
            Category:="ESP", _
            ArgumentDescriptions:=ESP_head_m
            
    Application.MacroOptions _
            Macro:="ESP_eff_fr", _
            Description:="Функция выдает номинальный КПД ЭЦН для заданных параметров (с учетом поправки на вязкость, если задана), м", _
            Category:="ESP", _
            ArgumentDescriptions:=ESP_head_m
    
    Application.MacroOptions _
            Macro:="ESP_name", _
            Description:="Функция выдает название насоса в базе данных", _
            Category:="ESP", _
            ArgumentDescriptions:=Array(pump_id)
            
    Application.MacroOptions _
            Macro:="esp_max_rate_m3day", _
            Description:="Функция возвращает значение максимального номинального дебита на заданной частоте", _
            Category:="ESP", _
            ArgumentDescriptions:=Array(freq_Hz, pump_id)
            
    Application.MacroOptions _
            Macro:="ESP_optRate_m3day", _
            Description:="Функция возвращает значение оптимального номинального дебита на заданной частоте", _
            Category:="ESP", _
            ArgumentDescriptions:=Array(freq_Hz, pump_id)
            
    Application.MacroOptions _
            Macro:="ESP_id_by_rate", _
            Description:="Функция идентификатор насоса в базе данных для заданного дебита (номер типового насоса)", _
            Category:="ESP", _
            ArgumentDescriptions:=Array("Номинальный дебит насоса - типоразмер")
            
            
End Sub
