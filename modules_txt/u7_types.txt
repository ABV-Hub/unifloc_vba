'=======================================================================================
'Unifloc 7.13  Lepus                                           khabibullin.ra@gubkin.ru
'Petroleum engineering calculations modules (macroses)
'2000 - 2019
'
'=======================================================================================
' types definition module
Option Explicit
' hydraulic correlations types
Public Enum H_CORRELATION
    BeggsBrill = 0
    Ansari = 1
    Unified = 2
    Gray = 3
    HagedornBrown = 4
    SakharovMokhov = 5
    gas = 10
    Water = 11
End Enum
' PVT correlation set to be used
Public Enum PVT_CORRELATION
    Standing_based = 0 '
    McCain_based = 1 '
    straigth_line = 2
End Enum
Public Enum Z_CORRELATION
    z_BB = 0
    z_Dranchuk = 1
End Enum
Public Enum TEMP_CALC_METHOD
    StartEndTemp = 0
    GeoGradTemp = 1
    AmbientTemp = 2
End Enum
' gas separation in well at pump intake. calculation method
Public Enum SEPAR_CALC_METHOD
    fullyManual = 3
    valueManual = 2
    pressureManual = 1
    byCorrealation = 0
End Enum
' standard port sizes for whetherford r1 glv
Public Enum GLV_R1_PORT_SIZE
    R1_port_1_8 = 3.18
    R1_port_5_32 = 3.97
    R1_port_3_16 = 4.76
    R1_port_1_4 = 6.35
    R1_port_5_16 = 7.94
End Enum
' multiphase flow in pipe and well calculation method
Public Type PARAMCALC
     correlation As H_CORRELATION
     CalcAlongCoord As Boolean
     FlowAlongCoord As Boolean
     temp_method As TEMP_CALC_METHOD          ' temperature caclulation method
     length_gas_m As Double                     ' length in pipe where correlation changes. before - gas, after - correlation
End Type
' тип для описания термобарических условий  (для расчетов)
' используется для передачи данных. Поддерживает только один вариант размерности
Public Type PTtype
    p_atma As Double
    t_C As Double
End Type
Public Type PCAS_HDYN_type
    p_cas_atma As Double
    hdyn_m As Double
    self_flow_condition As Boolean
    pump_off_condition As Boolean
    correct As Boolean
End Type
' тип для описания параметров работы электрического двигателя
Public Type MOTOR_DATA
    U_lin_V As Double       ' напряжение линейное (между фазами)
    I_lin_A As Double       ' ток линейный (в линии)
    U_phase_V As Double     ' напряжение фазное (между фазой и нулем)
    I_phase_A As Double     ' ток фазный (в обмотке)
    f_Hz As Double          ' частота синхронная (вращение поля)
    eff_d As Double         ' КПД
    Cosphi As Double       ' коэффициент мощности
    S_d As Double           ' проскользывание
    Pshaft_kW As Double     ' мощность на валу механическая
    Pelectr_kW As Double    ' мощность подводимая электрическая
    Mshaft_Nm As Double     ' момент на валу - механический
    load_d As Double        ' загрузка двигателя
End Type
Public Type PIPE_FLOW_PARAMS
  md_m As Double         ' pipe measured depth (from start - top)
  vd_m As Double         ' pipe vertical depth from start - top
  p_atma As Double        ' pipe pressure at measured depth
  t_C As Double          ' pipe temp at measured depth
  
  dp_dl As Double
  dt_dl As Double
  
  dpdl_g_atmm As Double  ' gravity gradient at measured depth
  dpdl_f_atmm As Double  ' friction gradient at measured depth
  dpdl_a_atmm As Double  ' acceleration gradient at measured depth
  v_sl_msec As Double        ' superficial liquid velosity
  v_sg_msec As Double        ' superficial gas velosity
  h_l_d As Double            ' liquid hold up
  fpat As Double             ' flow pattern code
  thete_deg As Double
  roughness_m As Double
  
  rs_m3m3 As Double         ' растворенный газ в нефти в потоке
  gasfrac As Double         ' расходное содержание газа в потоке
  
  mu_oil_cP As Double          ' вязкость нефть в потоке
  mu_wat_cP As Double          ' вязкость воды в потоке
  mu_gas_cP As Double          ' вязкость газа в потоке
  mu_mix_cP As Double        ' вязкость смеси в потоке
  
  Rhoo_kgm3 As Double       ' плотность нефти
  Rhow_kgm3 As Double       ' плотность воды
  rhol_kgm3 As Double       ' плотность жидкости
  Rhog_kgm3 As Double       ' плотность газа
  rhomix_kgm3 As Double     ' плотность смеси в потоке
  
  q_oil_m3day As Double        ' расход нефти в рабочих условиях
  qw_m3day As Double        ' расход воды в рабочих условиях
  Qg_m3day As Double        ' расход газа в рабочих условиях
  
  mo_kgsec As Double        ' массовый расход нефти в рабочих условиях
  mw_kgsec As Double        ' массовый расход воды в рабочих условиях
  mg_kgsec As Double        ' массовый расход газа в рабочих условиях
  
  vl_msec As Double         ' скорость жидкости реальная
  vg_msec As Double         ' скорость газа реальная
End Type
'Public Enum VAL_FROM_SHEET
'    VAL_DOUBLE = 0
'    VAL_STRING = 1
'    VAL_CURVE = 2
'    VAL_BOOLEAN = 3
'End Enum
Public Enum GAS_INTO_SOLUTION
    GasGoesIntoSolution = 1
    GasnotGoesIntoSolution = 0
End Enum
'Public Type CONTEXT_DATA
'    Description As String   ' описание текущего контекста выполняемых действий
'    method As String
'    Class As String
'    description_out As String ' внешний контекст
'End Type
' уровни влияния сообщения - могут быть использованы для оценки достоверности расчетов
'Public Enum MESSAGE_LEVEL
'    mlCritical = 0
'    mlModerate = 1
'    mlStandard = 2
'    mlLow = 3
'End Enum
Public Enum CALC_RESULTS
    nocurves = 0
    maincurves = 1
    allCurves = 2
End Enum
'Public Type WELL_DESCRIPTION_SIMPLE
'     h_perf_m As Double
'     h_pump_m As Double
'     udl_m As Double
'     d_cas_mm As Double
'     dtub_mm As Double
'     dchoke_mm As Double
'     roughness_m As Double
'End Type
'=========================================================================================
'types support functions
'=========================================================================================
Public Function set_calc_flow_param( _
                Optional ByVal calc_along_coord As Boolean = False, _
                Optional ByVal flow_along_coord As Boolean = False, _
                Optional ByVal hcor As H_CORRELATION = Ansari, _
                Optional ByVal temp_method As TEMP_CALC_METHOD = StartEndTemp, _
                Optional ByVal length_gas_m As Double = 0) As PARAMCALC
    Dim prm As PARAMCALC
    prm.CalcAlongCoord = calc_along_coord
    prm.FlowAlongCoord = flow_along_coord
    prm.correlation = hcor
    prm.temp_method = temp_method
    prm.length_gas_m = length_gas_m
    set_calc_flow_param = prm
End Function
Public Function sum_PT(PT1 As PTtype, PT2 As PTtype) As PTtype
    sum_PT.p_atma = PT1.p_atma + PT2.p_atma
    sum_PT.t_C = PT1.t_C + PT2.t_C
End Function
Public Function subtract_PT(PT1 As PTtype, PT2 As PTtype) As PTtype
    subtract_PT.p_atma = PT1.p_atma - PT2.p_atma
    subtract_PT.t_C = PT1.t_C - PT2.t_C
End Function
Public Function set_PT(ByVal p As Double, ByVal t As Double) As PTtype
    set_PT.p_atma = p
    set_PT.t_C = t
End Function
Public Function PT_to_array(pt As PTtype)
    PT_to_array = Array(pt.p_atma, pt.t_C)
End Function

