' функция расчета забойного давления по устьевому для скважины
' расчет сверху-вниз, считает быстро за счет угадывания сепарации
'                     температура только линейная или по градиенту
Public Function well_pwf_plin_atma( _
                 ByVal q_m3day As Double, _
                 ByVal fw_perc As Double, _
                 ByVal plin_atma As Double, _
        Optional ByVal Pcas_atma As Double = -1, _
        Optional ByVal wellStr As String = WELL_DEFAULT, _
        Optional ByVal PVTstr As String = PVT_DEFAULT, _
        Optional ByVal ESPstr As String = ESP_DEFAULT, _
        Optional ByVal HydrCorr As H_CORRELATION = 0, _
        Optional ByVal ksep_fr As Double = -1, _
        Optional ByVal Psep_atma As Double = 40, _
        Optional ByVal Tsep_C As Double = 40, _
        Optional ByVal Kdegr_d As Double = 0, _
        Optional ByVal param_num As Integer = 5)
' функция расчета забойного давления скважины по линейному
' на основе устьевых параметров работы скважины
' исходные параметры
' q_m3day    - дебит жидкости, на поверхности
' fw_perc    - обводненность (объемная на поверхности)
' plin_atma - линейное (устьевое) давление
' ----------- опциональные параметры
' Pcas_atma - затрубное давление
'     если не задано динамический уровень не рассчитывается
' wellStr  - закодированные параметры конструкции скважины
' PVTstr - закодированные параметры флюидов
' ESPStr - закодированные параметры УЭЦН
' HydrCorr      - гидравлическая корреляция, H_CORRELATION
'                   BeggsBrill = 0
'                   Ansari = 1
'                   Unified = 2
'                   Gray = 3
'                   HagedornBrown = 4
'                   SakharovMokhov = 5
' ksep_fr - коэффициент сепарации.
'           если задан - то используется вместо расчетного
'           явное задание коэффициента серации ускоряет расчет
' Psep_atma - давление сепарации
' Tsep_C - температура сепарации
'           при расчете сверху вниз неизвестны параметры сепарации
'           если задать их явно (угадать)
'           тогда расчет упрощается и ускоряется
' Kdegr_d - коэффициент деградации УЭЦН
' param_num - параметры для вывода в качестве результата
'             если не задан выводятся все в виде массива
' ----------- результаты расчета
' массив параметры работы системы "пласт - скважина - УЭЦН"
